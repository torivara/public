Results of checkov linter (version 2.3.360)
See documentation on https://megalinter.io/7.3.0/descriptors/repository_checkov/
-----------------------------------------------

‚ùå [ERROR] for workspace /github/workspace
Linter raw log:
2023-08-25 13:24:08,257 [MainThread  ] [WARNI]  Module terraform/functionapp/modules/app/examples/modules/app:latest failed to load via <class 'checkov.terraform.module_loading.loaders.local_path_loader.LocalPathLoader'>
2023-08-25 13:24:08,257 [MainThread  ] [WARNI]  Unable to load module - source: terraform/functionapp/modules/app/examples/modules/app, version: latest, error: terraform/functionapp/modules/app/examples/modules/app
2023-08-25 13:24:08,257 [MainThread  ] [WARNI]  Module terraform/functionapp/modules/app/examples/modules/app:latest failed to load via <class 'checkov.terraform.module_loading.loaders.local_path_loader.LocalPathLoader'>
2023-08-25 13:24:08,257 [MainThread  ] [WARNI]  Unable to load module - source: terraform/functionapp/modules/app/examples/modules/app, version: latest, error: terraform/functionapp/modules/app/examples/modules/app
2023-08-25 13:24:08,257 [MainThread  ] [WARNI]  Module terraform/functionapp/modules/app/examples/modules/app:latest failed to load via <class 'checkov.terraform.module_loading.loaders.local_path_loader.LocalPathLoader'>
2023-08-25 13:24:08,257 [MainThread  ] [WARNI]  Unable to load module - source: terraform/functionapp/modules/app/examples/modules/app, version: latest, error: terraform/functionapp/modules/app/examples/modules/app
terraform scan results:

Passed checks: 83, Failed checks: 164, Skipped checks: 0

Check: CKV_AZURE_168: "Ensure Azure Kubernetes Cluster (AKS) nodes should use a minimum number of 50 pods."
	FAILED for resource: azurerm_kubernetes_cluster.k8s
	File: /terraform/agic/aks.tf:1-46

		1  | resource "azurerm_kubernetes_cluster" "k8s" {
		2  |   name                    = var.aks_name
		3  |   location                = azurerm_resource_group.rg.location
		4  |   dns_prefix              = var.aks_dns_prefix
		5  |   private_cluster_enabled = true
		6  | 
		7  |   resource_group_name = azurerm_resource_group.rg.name
		8  | 
		9  |   http_application_routing_enabled = false
		10 | 
		11 |   default_node_pool {
		12 |     name            = "agentpool"
		13 |     node_count      = var.aks_agent_count
		14 |     vm_size         = var.aks_agent_vm_size
		15 |     os_disk_size_gb = var.aks_agent_os_disk_size
		16 |     vnet_subnet_id  = resource.azurerm_subnet.kubesubnet.id
		17 |   }
		18 | 
		19 |   identity {
		20 |     type = "SystemAssigned"
		21 |   }
		22 | 
		23 |   network_profile {
		24 |     network_plugin     = "azure"
		25 |     dns_service_ip     = var.aks_dns_service_ip
		26 |     docker_bridge_cidr = var.aks_docker_bridge_cidr
		27 |     service_cidr       = var.aks_service_cidr
		28 |     load_balancer_sku  = "standard"
		29 |   }
		30 | 
		31 |   ingress_application_gateway {
		32 |     gateway_id = azurerm_application_gateway.network.id
		33 |   }
		34 | 
		35 |   azure_active_directory_role_based_access_control {
		36 |     managed                = true
		37 |     azure_rbac_enabled     = true
		38 |     admin_group_object_ids = var.admin_group_object_ids
		39 |   }
		40 | 
		41 |   depends_on = [
		42 |     azurerm_virtual_network.test,
		43 |     azurerm_application_gateway.network
		44 |   ]
		45 |   tags = var.tags
		46 | }

Check: CKV_AZURE_4: "Ensure AKS logging to Azure Monitoring is Configured"
	FAILED for resource: azurerm_kubernetes_cluster.k8s
	File: /terraform/agic/aks.tf:1-46
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-1.html

		1  | resource "azurerm_kubernetes_cluster" "k8s" {
		2  |   name                    = var.aks_name
		3  |   location                = azurerm_resource_group.rg.location
		4  |   dns_prefix              = var.aks_dns_prefix
		5  |   private_cluster_enabled = true
		6  | 
		7  |   resource_group_name = azurerm_resource_group.rg.name
		8  | 
		9  |   http_application_routing_enabled = false
		10 | 
		11 |   default_node_pool {
		12 |     name            = "agentpool"
		13 |     node_count      = var.aks_agent_count
		14 |     vm_size         = var.aks_agent_vm_size
		15 |     os_disk_size_gb = var.aks_agent_os_disk_size
		16 |     vnet_subnet_id  = resource.azurerm_subnet.kubesubnet.id
		17 |   }
		18 | 
		19 |   identity {
		20 |     type = "SystemAssigned"
		21 |   }
		22 | 
		23 |   network_profile {
		24 |     network_plugin     = "azure"
		25 |     dns_service_ip     = var.aks_dns_service_ip
		26 |     docker_bridge_cidr = var.aks_docker_bridge_cidr
		27 |     service_cidr       = var.aks_service_cidr
		28 |     load_balancer_sku  = "standard"
		29 |   }
		30 | 
		31 |   ingress_application_gateway {
		32 |     gateway_id = azurerm_application_gateway.network.id
		33 |   }
		34 | 
		35 |   azure_active_directory_role_based_access_control {
		36 |     managed                = true
		37 |     azure_rbac_enabled     = true
		38 |     admin_group_object_ids = var.admin_group_object_ids
		39 |   }
		40 | 
		41 |   depends_on = [
		42 |     azurerm_virtual_network.test,
		43 |     azurerm_application_gateway.network
		44 |   ]
		45 |   tags = var.tags
		46 | }

Check: CKV_AZURE_171: "Ensure AKS cluster upgrade channel is chosen"
	FAILED for resource: azurerm_kubernetes_cluster.k8s
	File: /terraform/agic/aks.tf:1-46

		1  | resource "azurerm_kubernetes_cluster" "k8s" {
		2  |   name                    = var.aks_name
		3  |   location                = azurerm_resource_group.rg.location
		4  |   dns_prefix              = var.aks_dns_prefix
		5  |   private_cluster_enabled = true
		6  | 
		7  |   resource_group_name = azurerm_resource_group.rg.name
		8  | 
		9  |   http_application_routing_enabled = false
		10 | 
		11 |   default_node_pool {
		12 |     name            = "agentpool"
		13 |     node_count      = var.aks_agent_count
		14 |     vm_size         = var.aks_agent_vm_size
		15 |     os_disk_size_gb = var.aks_agent_os_disk_size
		16 |     vnet_subnet_id  = resource.azurerm_subnet.kubesubnet.id
		17 |   }
		18 | 
		19 |   identity {
		20 |     type = "SystemAssigned"
		21 |   }
		22 | 
		23 |   network_profile {
		24 |     network_plugin     = "azure"
		25 |     dns_service_ip     = var.aks_dns_service_ip
		26 |     docker_bridge_cidr = var.aks_docker_bridge_cidr
		27 |     service_cidr       = var.aks_service_cidr
		28 |     load_balancer_sku  = "standard"
		29 |   }
		30 | 
		31 |   ingress_application_gateway {
		32 |     gateway_id = azurerm_application_gateway.network.id
		33 |   }
		34 | 
		35 |   azure_active_directory_role_based_access_control {
		36 |     managed                = true
		37 |     azure_rbac_enabled     = true
		38 |     admin_group_object_ids = var.admin_group_object_ids
		39 |   }
		40 | 
		41 |   depends_on = [
		42 |     azurerm_virtual_network.test,
		43 |     azurerm_application_gateway.network
		44 |   ]
		45 |   tags = var.tags
		46 | }

Check: CKV_AZURE_141: "Ensure AKS local admin account is disabled"
	FAILED for resource: azurerm_kubernetes_cluster.k8s
	File: /terraform/agic/aks.tf:1-46
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-iam-policies/ensure-azure-kubernetes-service-aks-local-admin-account-is-disabled.html

		1  | resource "azurerm_kubernetes_cluster" "k8s" {
		2  |   name                    = var.aks_name
		3  |   location                = azurerm_resource_group.rg.location
		4  |   dns_prefix              = var.aks_dns_prefix
		5  |   private_cluster_enabled = true
		6  | 
		7  |   resource_group_name = azurerm_resource_group.rg.name
		8  | 
		9  |   http_application_routing_enabled = false
		10 | 
		11 |   default_node_pool {
		12 |     name            = "agentpool"
		13 |     node_count      = var.aks_agent_count
		14 |     vm_size         = var.aks_agent_vm_size
		15 |     os_disk_size_gb = var.aks_agent_os_disk_size
		16 |     vnet_subnet_id  = resource.azurerm_subnet.kubesubnet.id
		17 |   }
		18 | 
		19 |   identity {
		20 |     type = "SystemAssigned"
		21 |   }
		22 | 
		23 |   network_profile {
		24 |     network_plugin     = "azure"
		25 |     dns_service_ip     = var.aks_dns_service_ip
		26 |     docker_bridge_cidr = var.aks_docker_bridge_cidr
		27 |     service_cidr       = var.aks_service_cidr
		28 |     load_balancer_sku  = "standard"
		29 |   }
		30 | 
		31 |   ingress_application_gateway {
		32 |     gateway_id = azurerm_application_gateway.network.id
		33 |   }
		34 | 
		35 |   azure_active_directory_role_based_access_control {
		36 |     managed                = true
		37 |     azure_rbac_enabled     = true
		38 |     admin_group_object_ids = var.admin_group_object_ids
		39 |   }
		40 | 
		41 |   depends_on = [
		42 |     azurerm_virtual_network.test,
		43 |     azurerm_application_gateway.network
		44 |   ]
		45 |   tags = var.tags
		46 | }

Check: CKV_AZURE_172: "Ensure autorotation of Secrets Store CSI Driver secrets for AKS clusters"
	FAILED for resource: azurerm_kubernetes_cluster.k8s
	File: /terraform/agic/aks.tf:1-46

		1  | resource "azurerm_kubernetes_cluster" "k8s" {
		2  |   name                    = var.aks_name
		3  |   location                = azurerm_resource_group.rg.location
		4  |   dns_prefix              = var.aks_dns_prefix
		5  |   private_cluster_enabled = true
		6  | 
		7  |   resource_group_name = azurerm_resource_group.rg.name
		8  | 
		9  |   http_application_routing_enabled = false
		10 | 
		11 |   default_node_pool {
		12 |     name            = "agentpool"
		13 |     node_count      = var.aks_agent_count
		14 |     vm_size         = var.aks_agent_vm_size
		15 |     os_disk_size_gb = var.aks_agent_os_disk_size
		16 |     vnet_subnet_id  = resource.azurerm_subnet.kubesubnet.id
		17 |   }
		18 | 
		19 |   identity {
		20 |     type = "SystemAssigned"
		21 |   }
		22 | 
		23 |   network_profile {
		24 |     network_plugin     = "azure"
		25 |     dns_service_ip     = var.aks_dns_service_ip
		26 |     docker_bridge_cidr = var.aks_docker_bridge_cidr
		27 |     service_cidr       = var.aks_service_cidr
		28 |     load_balancer_sku  = "standard"
		29 |   }
		30 | 
		31 |   ingress_application_gateway {
		32 |     gateway_id = azurerm_application_gateway.network.id
		33 |   }
		34 | 
		35 |   azure_active_directory_role_based_access_control {
		36 |     managed                = true
		37 |     azure_rbac_enabled     = true
		38 |     admin_group_object_ids = var.admin_group_object_ids
		39 |   }
		40 | 
		41 |   depends_on = [
		42 |     azurerm_virtual_network.test,
		43 |     azurerm_application_gateway.network
		44 |   ]
		45 |   tags = var.tags
		46 | }

Check: CKV_AZURE_7: "Ensure AKS cluster has Network Policy configured"
	FAILED for resource: azurerm_kubernetes_cluster.k8s
	File: /terraform/agic/aks.tf:1-46
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-4.html

		1  | resource "azurerm_kubernetes_cluster" "k8s" {
		2  |   name                    = var.aks_name
		3  |   location                = azurerm_resource_group.rg.location
		4  |   dns_prefix              = var.aks_dns_prefix
		5  |   private_cluster_enabled = true
		6  | 
		7  |   resource_group_name = azurerm_resource_group.rg.name
		8  | 
		9  |   http_application_routing_enabled = false
		10 | 
		11 |   default_node_pool {
		12 |     name            = "agentpool"
		13 |     node_count      = var.aks_agent_count
		14 |     vm_size         = var.aks_agent_vm_size
		15 |     os_disk_size_gb = var.aks_agent_os_disk_size
		16 |     vnet_subnet_id  = resource.azurerm_subnet.kubesubnet.id
		17 |   }
		18 | 
		19 |   identity {
		20 |     type = "SystemAssigned"
		21 |   }
		22 | 
		23 |   network_profile {
		24 |     network_plugin     = "azure"
		25 |     dns_service_ip     = var.aks_dns_service_ip
		26 |     docker_bridge_cidr = var.aks_docker_bridge_cidr
		27 |     service_cidr       = var.aks_service_cidr
		28 |     load_balancer_sku  = "standard"
		29 |   }
		30 | 
		31 |   ingress_application_gateway {
		32 |     gateway_id = azurerm_application_gateway.network.id
		33 |   }
		34 | 
		35 |   azure_active_directory_role_based_access_control {
		36 |     managed                = true
		37 |     azure_rbac_enabled     = true
		38 |     admin_group_object_ids = var.admin_group_object_ids
		39 |   }
		40 | 
		41 |   depends_on = [
		42 |     azurerm_virtual_network.test,
		43 |     azurerm_application_gateway.network
		44 |   ]
		45 |   tags = var.tags
		46 | }

Check: CKV_AZURE_117: "Ensure that AKS uses disk encryption set"
	FAILED for resource: azurerm_kubernetes_cluster.k8s
	File: /terraform/agic/aks.tf:1-46
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-uses-disk-encryption-set.html

		1  | resource "azurerm_kubernetes_cluster" "k8s" {
		2  |   name                    = var.aks_name
		3  |   location                = azurerm_resource_group.rg.location
		4  |   dns_prefix              = var.aks_dns_prefix
		5  |   private_cluster_enabled = true
		6  | 
		7  |   resource_group_name = azurerm_resource_group.rg.name
		8  | 
		9  |   http_application_routing_enabled = false
		10 | 
		11 |   default_node_pool {
		12 |     name            = "agentpool"
		13 |     node_count      = var.aks_agent_count
		14 |     vm_size         = var.aks_agent_vm_size
		15 |     os_disk_size_gb = var.aks_agent_os_disk_size
		16 |     vnet_subnet_id  = resource.azurerm_subnet.kubesubnet.id
		17 |   }
		18 | 
		19 |   identity {
		20 |     type = "SystemAssigned"
		21 |   }
		22 | 
		23 |   network_profile {
		24 |     network_plugin     = "azure"
		25 |     dns_service_ip     = var.aks_dns_service_ip
		26 |     docker_bridge_cidr = var.aks_docker_bridge_cidr
		27 |     service_cidr       = var.aks_service_cidr
		28 |     load_balancer_sku  = "standard"
		29 |   }
		30 | 
		31 |   ingress_application_gateway {
		32 |     gateway_id = azurerm_application_gateway.network.id
		33 |   }
		34 | 
		35 |   azure_active_directory_role_based_access_control {
		36 |     managed                = true
		37 |     azure_rbac_enabled     = true
		38 |     admin_group_object_ids = var.admin_group_object_ids
		39 |   }
		40 | 
		41 |   depends_on = [
		42 |     azurerm_virtual_network.test,
		43 |     azurerm_application_gateway.network
		44 |   ]
		45 |   tags = var.tags
		46 | }

Check: CKV_AZURE_116: "Ensure that AKS uses Azure Policies Add-on"
	FAILED for resource: azurerm_kubernetes_cluster.k8s
	File: /terraform/agic/aks.tf:1-46
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-uses-azure-policies-add-on.html

		1  | resource "azurerm_kubernetes_cluster" "k8s" {
		2  |   name                    = var.aks_name
		3  |   location                = azurerm_resource_group.rg.location
		4  |   dns_prefix              = var.aks_dns_prefix
		5  |   private_cluster_enabled = true
		6  | 
		7  |   resource_group_name = azurerm_resource_group.rg.name
		8  | 
		9  |   http_application_routing_enabled = false
		10 | 
		11 |   default_node_pool {
		12 |     name            = "agentpool"
		13 |     node_count      = var.aks_agent_count
		14 |     vm_size         = var.aks_agent_vm_size
		15 |     os_disk_size_gb = var.aks_agent_os_disk_size
		16 |     vnet_subnet_id  = resource.azurerm_subnet.kubesubnet.id
		17 |   }
		18 | 
		19 |   identity {
		20 |     type = "SystemAssigned"
		21 |   }
		22 | 
		23 |   network_profile {
		24 |     network_plugin     = "azure"
		25 |     dns_service_ip     = var.aks_dns_service_ip
		26 |     docker_bridge_cidr = var.aks_docker_bridge_cidr
		27 |     service_cidr       = var.aks_service_cidr
		28 |     load_balancer_sku  = "standard"
		29 |   }
		30 | 
		31 |   ingress_application_gateway {
		32 |     gateway_id = azurerm_application_gateway.network.id
		33 |   }
		34 | 
		35 |   azure_active_directory_role_based_access_control {
		36 |     managed                = true
		37 |     azure_rbac_enabled     = true
		38 |     admin_group_object_ids = var.admin_group_object_ids
		39 |   }
		40 | 
		41 |   depends_on = [
		42 |     azurerm_virtual_network.test,
		43 |     azurerm_application_gateway.network
		44 |   ]
		45 |   tags = var.tags
		46 | }

Check: CKV_AZURE_170: "Ensure that AKS use the Paid Sku for its SLA"
	FAILED for resource: azurerm_kubernetes_cluster.k8s
	File: /terraform/agic/aks.tf:1-46

		1  | resource "azurerm_kubernetes_cluster" "k8s" {
		2  |   name                    = var.aks_name
		3  |   location                = azurerm_resource_group.rg.location
		4  |   dns_prefix              = var.aks_dns_prefix
		5  |   private_cluster_enabled = true
		6  | 
		7  |   resource_group_name = azurerm_resource_group.rg.name
		8  | 
		9  |   http_application_routing_enabled = false
		10 | 
		11 |   default_node_pool {
		12 |     name            = "agentpool"
		13 |     node_count      = var.aks_agent_count
		14 |     vm_size         = var.aks_agent_vm_size
		15 |     os_disk_size_gb = var.aks_agent_os_disk_size
		16 |     vnet_subnet_id  = resource.azurerm_subnet.kubesubnet.id
		17 |   }
		18 | 
		19 |   identity {
		20 |     type = "SystemAssigned"
		21 |   }
		22 | 
		23 |   network_profile {
		24 |     network_plugin     = "azure"
		25 |     dns_service_ip     = var.aks_dns_service_ip
		26 |     docker_bridge_cidr = var.aks_docker_bridge_cidr
		27 |     service_cidr       = var.aks_service_cidr
		28 |     load_balancer_sku  = "standard"
		29 |   }
		30 | 
		31 |   ingress_application_gateway {
		32 |     gateway_id = azurerm_application_gateway.network.id
		33 |   }
		34 | 
		35 |   azure_active_directory_role_based_access_control {
		36 |     managed                = true
		37 |     azure_rbac_enabled     = true
		38 |     admin_group_object_ids = var.admin_group_object_ids
		39 |   }
		40 | 
		41 |   depends_on = [
		42 |     azurerm_virtual_network.test,
		43 |     azurerm_application_gateway.network
		44 |   ]
		45 |   tags = var.tags
		46 | }

Check: CKV_AZURE_218: "Ensure Application Gateway defines secure protocols for in transit communication"
	FAILED for resource: azurerm_application_gateway.network
	File: /terraform/agic/appgw.tf:19-100

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_217: "Ensure Azure Application gateways listener that allow connection requests over HTTP"
	FAILED for resource: azurerm_application_gateway.network
	File: /terraform/agic/appgw.tf:19-100

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_1: "Ensure Azure Instance does not use basic authentication(Use SSH Key Instead)"
	FAILED for resource: azurerm_linux_virtual_machine.jumpbox
	File: /terraform/agic/jumpbox.tf:42-67
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-1.html

		42 | resource "azurerm_linux_virtual_machine" "jumpbox" {
		43 |   name                = "jumpbox"
		44 |   resource_group_name = azurerm_resource_group.rg.name
		45 |   location            = azurerm_resource_group.rg.location
		46 |   size                = "Standard_D2s_v3"
		47 |   admin_username      = var.jumpbox_admin_username
		48 |   admin_password      = var.jumpbox_admin_password
		49 | 
		50 |   disable_password_authentication = false
		51 | 
		52 |   network_interface_ids = [
		53 |     azurerm_network_interface.jumpbox.id,
		54 |   ]
		55 | 
		56 |   os_disk {
		57 |     caching              = "ReadWrite"
		58 |     storage_account_type = "Standard_LRS"
		59 |   }
		60 | 
		61 |   source_image_reference {
		62 |     publisher = "Canonical"
		63 |     offer     = "0001-com-ubuntu-server-kinetic-daily"
		64 |     sku       = "22_10-daily"
		65 |     version   = "latest"
		66 |   }
		67 | }

Check: CKV_AZURE_149: "Ensure that Virtual machine does not enable password authentication"
	FAILED for resource: azurerm_linux_virtual_machine.jumpbox
	File: /terraform/agic/jumpbox.tf:42-67
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-azure-virtual-machine-does-not-enable-password-authentication.html

		42 | resource "azurerm_linux_virtual_machine" "jumpbox" {
		43 |   name                = "jumpbox"
		44 |   resource_group_name = azurerm_resource_group.rg.name
		45 |   location            = azurerm_resource_group.rg.location
		46 |   size                = "Standard_D2s_v3"
		47 |   admin_username      = var.jumpbox_admin_username
		48 |   admin_password      = var.jumpbox_admin_password
		49 | 
		50 |   disable_password_authentication = false
		51 | 
		52 |   network_interface_ids = [
		53 |     azurerm_network_interface.jumpbox.id,
		54 |   ]
		55 | 
		56 |   os_disk {
		57 |     caching              = "ReadWrite"
		58 |     storage_account_type = "Standard_LRS"
		59 |   }
		60 | 
		61 |   source_image_reference {
		62 |     publisher = "Canonical"
		63 |     offer     = "0001-com-ubuntu-server-kinetic-daily"
		64 |     sku       = "22_10-daily"
		65 |     version   = "latest"
		66 |   }
		67 | }

Check: CKV_AZURE_178: "Ensure linux VM enables SSH with keys for secure communication"
	FAILED for resource: azurerm_linux_virtual_machine.jumpbox
	File: /terraform/agic/jumpbox.tf:42-67

		42 | resource "azurerm_linux_virtual_machine" "jumpbox" {
		43 |   name                = "jumpbox"
		44 |   resource_group_name = azurerm_resource_group.rg.name
		45 |   location            = azurerm_resource_group.rg.location
		46 |   size                = "Standard_D2s_v3"
		47 |   admin_username      = var.jumpbox_admin_username
		48 |   admin_password      = var.jumpbox_admin_password
		49 | 
		50 |   disable_password_authentication = false
		51 | 
		52 |   network_interface_ids = [
		53 |     azurerm_network_interface.jumpbox.id,
		54 |   ]
		55 | 
		56 |   os_disk {
		57 |     caching              = "ReadWrite"
		58 |     storage_account_type = "Standard_LRS"
		59 |   }
		60 | 
		61 |   source_image_reference {
		62 |     publisher = "Canonical"
		63 |     offer     = "0001-com-ubuntu-server-kinetic-daily"
		64 |     sku       = "22_10-daily"
		65 |     version   = "latest"
		66 |   }
		67 | }

Check: CKV_AZURE_50: "Ensure Virtual Machine Extensions are not Installed"
	FAILED for resource: azurerm_linux_virtual_machine.jumpbox
	File: /terraform/agic/jumpbox.tf:42-67
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-14.html

		42 | resource "azurerm_linux_virtual_machine" "jumpbox" {
		43 |   name                = "jumpbox"
		44 |   resource_group_name = azurerm_resource_group.rg.name
		45 |   location            = azurerm_resource_group.rg.location
		46 |   size                = "Standard_D2s_v3"
		47 |   admin_username      = var.jumpbox_admin_username
		48 |   admin_password      = var.jumpbox_admin_password
		49 | 
		50 |   disable_password_authentication = false
		51 | 
		52 |   network_interface_ids = [
		53 |     azurerm_network_interface.jumpbox.id,
		54 |   ]
		55 | 
		56 |   os_disk {
		57 |     caching              = "ReadWrite"
		58 |     storage_account_type = "Standard_LRS"
		59 |   }
		60 | 
		61 |   source_image_reference {
		62 |     publisher = "Canonical"
		63 |     offer     = "0001-com-ubuntu-server-kinetic-daily"
		64 |     sku       = "22_10-daily"
		65 |     version   = "latest"
		66 |   }
		67 | }

Check: CKV_AZURE_212: "Ensure App Service has a minimum number of instances for failover"
	FAILED for resource: azurerm_service_plan.example[0]
	File: /terraform/appgateway/app.tf:20-27

		20 | resource "azurerm_service_plan" "example" {
		21 |   count               = length(local.app_services)
		22 |   name                = "${lower(local.app_services[count.index].kind)}-asp"
		23 |   location            = azurerm_resource_group.example.location
		24 |   resource_group_name = azurerm_resource_group.example.name
		25 |   sku_name            = "B1"
		26 |   os_type             = "Windows"
		27 | }

Check: CKV_AZURE_211: "Ensure App Service plan suitable for production use"
	FAILED for resource: azurerm_service_plan.example[0]
	File: /terraform/appgateway/app.tf:20-27

		20 | resource "azurerm_service_plan" "example" {
		21 |   count               = length(local.app_services)
		22 |   name                = "${lower(local.app_services[count.index].kind)}-asp"
		23 |   location            = azurerm_resource_group.example.location
		24 |   resource_group_name = azurerm_resource_group.example.name
		25 |   sku_name            = "B1"
		26 |   os_type             = "Windows"
		27 | }

Check: CKV_AZURE_17: "Ensure the web app has 'Client Certificates (Incoming client certificates)' set"
	FAILED for resource: azurerm_windows_web_app.example[0]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-7.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_16: "Ensure that Register with Azure Active Directory is enabled on App Service"
	FAILED for resource: azurerm_windows_web_app.example[0]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-iam-policies/bc-azr-iam-1.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_66: "Ensure that App service enables failed request tracing"
	FAILED for resource: azurerm_windows_web_app.example[0]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/ensure-that-app-service-enables-failed-request-tracing.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_18: "Ensure that 'HTTP Version' is the latest if used to run the web app"
	FAILED for resource: azurerm_windows_web_app.example[0]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-8.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_65: "Ensure that App service enables detailed error messages"
	FAILED for resource: azurerm_windows_web_app.example[0]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/tbdensure-that-app-service-enables-detailed-error-messages.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_71: "Ensure that Managed identity provider is enabled for app services"
	FAILED for resource: azurerm_windows_web_app.example[0]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-managed-identity-provider-is-enabled-for-app-services.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_88: "Ensure that app services use Azure Files"
	FAILED for resource: azurerm_windows_web_app.example[0]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-app-services-use-azure-files.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_13: "Ensure App Service Authentication is set on Azure App Service"
	FAILED for resource: azurerm_windows_web_app.example[0]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-2.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_213: "Ensure that App Service configures health check"
	FAILED for resource: azurerm_windows_web_app.example[0]
	File: /terraform/appgateway/app.tf:29-37

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_78: "Ensure FTP deployments are disabled"
	FAILED for resource: azurerm_windows_web_app.example[0]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-ftp-deployments-are-disabled.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_63: "Ensure that App service enables HTTP logging"
	FAILED for resource: azurerm_windows_web_app.example[0]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/ensure-that-app-service-enables-http-logging.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_14: "Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service"
	FAILED for resource: azurerm_windows_web_app.example[0]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-5.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_212: "Ensure App Service has a minimum number of instances for failover"
	FAILED for resource: azurerm_service_plan.example[1]
	File: /terraform/appgateway/app.tf:20-27

		20 | resource "azurerm_service_plan" "example" {
		21 |   count               = length(local.app_services)
		22 |   name                = "${lower(local.app_services[count.index].kind)}-asp"
		23 |   location            = azurerm_resource_group.example.location
		24 |   resource_group_name = azurerm_resource_group.example.name
		25 |   sku_name            = "B1"
		26 |   os_type             = "Windows"
		27 | }

Check: CKV_AZURE_211: "Ensure App Service plan suitable for production use"
	FAILED for resource: azurerm_service_plan.example[1]
	File: /terraform/appgateway/app.tf:20-27

		20 | resource "azurerm_service_plan" "example" {
		21 |   count               = length(local.app_services)
		22 |   name                = "${lower(local.app_services[count.index].kind)}-asp"
		23 |   location            = azurerm_resource_group.example.location
		24 |   resource_group_name = azurerm_resource_group.example.name
		25 |   sku_name            = "B1"
		26 |   os_type             = "Windows"
		27 | }

Check: CKV_AZURE_17: "Ensure the web app has 'Client Certificates (Incoming client certificates)' set"
	FAILED for resource: azurerm_windows_web_app.example[1]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-7.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_16: "Ensure that Register with Azure Active Directory is enabled on App Service"
	FAILED for resource: azurerm_windows_web_app.example[1]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-iam-policies/bc-azr-iam-1.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_66: "Ensure that App service enables failed request tracing"
	FAILED for resource: azurerm_windows_web_app.example[1]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/ensure-that-app-service-enables-failed-request-tracing.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_18: "Ensure that 'HTTP Version' is the latest if used to run the web app"
	FAILED for resource: azurerm_windows_web_app.example[1]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-8.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_65: "Ensure that App service enables detailed error messages"
	FAILED for resource: azurerm_windows_web_app.example[1]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/tbdensure-that-app-service-enables-detailed-error-messages.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_71: "Ensure that Managed identity provider is enabled for app services"
	FAILED for resource: azurerm_windows_web_app.example[1]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-managed-identity-provider-is-enabled-for-app-services.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_88: "Ensure that app services use Azure Files"
	FAILED for resource: azurerm_windows_web_app.example[1]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-app-services-use-azure-files.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_13: "Ensure App Service Authentication is set on Azure App Service"
	FAILED for resource: azurerm_windows_web_app.example[1]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-2.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_213: "Ensure that App Service configures health check"
	FAILED for resource: azurerm_windows_web_app.example[1]
	File: /terraform/appgateway/app.tf:29-37

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_78: "Ensure FTP deployments are disabled"
	FAILED for resource: azurerm_windows_web_app.example[1]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-ftp-deployments-are-disabled.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_63: "Ensure that App service enables HTTP logging"
	FAILED for resource: azurerm_windows_web_app.example[1]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/ensure-that-app-service-enables-http-logging.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_14: "Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service"
	FAILED for resource: azurerm_windows_web_app.example[1]
	File: /terraform/appgateway/app.tf:29-37
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-5.html

		29 | resource "azurerm_windows_web_app" "example" {
		30 |   count               = length(local.app_services)
		31 |   name                = "${lower(local.app_services[count.index].kind)}-appservice"
		32 |   location            = azurerm_resource_group.example.location
		33 |   resource_group_name = azurerm_resource_group.example.name
		34 |   service_plan_id     = azurerm_service_plan.example[count.index].id
		35 | 
		36 |   site_config {}
		37 | }

Check: CKV_AZURE_218: "Ensure Application Gateway defines secure protocols for in transit communication"
	FAILED for resource: azurerm_application_gateway.network
	File: /terraform/appgateway/gateway.tf:14-97

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_217: "Ensure Azure Application gateways listener that allow connection requests over HTTP"
	FAILED for resource: azurerm_application_gateway.network
	File: /terraform/appgateway/gateway.tf:14-97

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_110: "Ensure that key vault enables purge protection"
	FAILED for resource: module.functionapp-dev.azurerm_key_vault.kv
	File: /terraform/functionapp/modules/app/key_vault.tf:1-17
	Calling File: /terraform/functionapp/main.tf:4-9
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-enables-purge-protection.html

		1  | resource "azurerm_key_vault" "kv" {
		2  |   location                   = azurerm_resource_group.rg.location
		3  |   name                       = "${local.resource_prefix}-kv"
		4  |   resource_group_name        = azurerm_resource_group.rg.name
		5  |   sku_name                   = "standard"
		6  |   tenant_id                  = data.azurerm_client_config.current.tenant_id
		7  |   enable_rbac_authorization  = true
		8  |   soft_delete_retention_days = 90
		9  | 
		10 |   network_acls {
		11 |     bypass                     = "AzureServices"
		12 |     default_action             = "Deny"
		13 |     ip_rules                   = azurerm_windows_function_app.app.outbound_ip_address_list
		14 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		15 |   }
		16 | 
		17 | }

Check: CKV_AZURE_42: "Ensure the key vault is recoverable"
	FAILED for resource: module.functionapp-dev.azurerm_key_vault.kv
	File: /terraform/functionapp/modules/app/key_vault.tf:1-17
	Calling File: /terraform/functionapp/main.tf:4-9
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-the-key-vault-is-recoverable.html

		1  | resource "azurerm_key_vault" "kv" {
		2  |   location                   = azurerm_resource_group.rg.location
		3  |   name                       = "${local.resource_prefix}-kv"
		4  |   resource_group_name        = azurerm_resource_group.rg.name
		5  |   sku_name                   = "standard"
		6  |   tenant_id                  = data.azurerm_client_config.current.tenant_id
		7  |   enable_rbac_authorization  = true
		8  |   soft_delete_retention_days = 90
		9  | 
		10 |   network_acls {
		11 |     bypass                     = "AzureServices"
		12 |     default_action             = "Deny"
		13 |     ip_rules                   = azurerm_windows_function_app.app.outbound_ip_address_list
		14 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		15 |   }
		16 | 
		17 | }

Check: CKV_AZURE_110: "Ensure that key vault enables purge protection"
	FAILED for resource: module.functionapp-test.azurerm_key_vault.kv
	File: /terraform/functionapp/modules/app/key_vault.tf:1-17
	Calling File: /terraform/functionapp/main.tf:11-18
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-enables-purge-protection.html

		1  | resource "azurerm_key_vault" "kv" {
		2  |   location                   = azurerm_resource_group.rg.location
		3  |   name                       = "${local.resource_prefix}-kv"
		4  |   resource_group_name        = azurerm_resource_group.rg.name
		5  |   sku_name                   = "standard"
		6  |   tenant_id                  = data.azurerm_client_config.current.tenant_id
		7  |   enable_rbac_authorization  = true
		8  |   soft_delete_retention_days = 90
		9  | 
		10 |   network_acls {
		11 |     bypass                     = "AzureServices"
		12 |     default_action             = "Deny"
		13 |     ip_rules                   = azurerm_windows_function_app.app.outbound_ip_address_list
		14 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		15 |   }
		16 | 
		17 | }

Check: CKV_AZURE_42: "Ensure the key vault is recoverable"
	FAILED for resource: module.functionapp-test.azurerm_key_vault.kv
	File: /terraform/functionapp/modules/app/key_vault.tf:1-17
	Calling File: /terraform/functionapp/main.tf:11-18
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-the-key-vault-is-recoverable.html

		1  | resource "azurerm_key_vault" "kv" {
		2  |   location                   = azurerm_resource_group.rg.location
		3  |   name                       = "${local.resource_prefix}-kv"
		4  |   resource_group_name        = azurerm_resource_group.rg.name
		5  |   sku_name                   = "standard"
		6  |   tenant_id                  = data.azurerm_client_config.current.tenant_id
		7  |   enable_rbac_authorization  = true
		8  |   soft_delete_retention_days = 90
		9  | 
		10 |   network_acls {
		11 |     bypass                     = "AzureServices"
		12 |     default_action             = "Deny"
		13 |     ip_rules                   = azurerm_windows_function_app.app.outbound_ip_address_list
		14 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		15 |   }
		16 | 
		17 | }

Check: CKV_AZURE_212: "Ensure App Service has a minimum number of instances for failover"
	FAILED for resource: module.functionapp-dev.azurerm_service_plan.asp
	File: /terraform/functionapp/modules/app/main.tf:21-27
	Calling File: /terraform/functionapp/main.tf:4-9

		21 | resource "azurerm_service_plan" "asp" {
		22 |   location            = azurerm_resource_group.rg.location
		23 |   name                = "${local.resource_prefix}-asp"
		24 |   resource_group_name = azurerm_resource_group.rg.name
		25 |   os_type             = var.os_type
		26 |   sku_name            = var.sku_name
		27 | }

Check: CKV_AZURE_212: "Ensure App Service has a minimum number of instances for failover"
	FAILED for resource: module.functionapp-test.azurerm_service_plan.asp
	File: /terraform/functionapp/modules/app/main.tf:21-27
	Calling File: /terraform/functionapp/main.tf:11-18

		21 | resource "azurerm_service_plan" "asp" {
		22 |   location            = azurerm_resource_group.rg.location
		23 |   name                = "${local.resource_prefix}-asp"
		24 |   resource_group_name = azurerm_resource_group.rg.name
		25 |   os_type             = var.os_type
		26 |   sku_name            = var.sku_name
		27 | }

Check: CKV_AZURE_35: "Ensure default network access rule for Storage Accounts is set to deny"
	FAILED for resource: module.functionapp-dev.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20
	Calling File: /terraform/functionapp/main.tf:4-9
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/set-default-network-access-rule-for-storage-accounts-to-deny.html

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV_AZURE_190: "Ensure that Storage blobs restrict public access"
	FAILED for resource: module.functionapp-dev.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20
	Calling File: /terraform/functionapp/main.tf:4-9

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV_AZURE_206: "Ensure that Storage Accounts use replication"
	FAILED for resource: module.functionapp-dev.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20
	Calling File: /terraform/functionapp/main.tf:4-9

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV_AZURE_33: "Ensure Storage logging is enabled for Queue service for read, write and delete requests"
	FAILED for resource: module.functionapp-dev.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20
	Calling File: /terraform/functionapp/main.tf:4-9
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/enable-requests-on-storage-logging-for-queue-service.html

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV_AZURE_59: "Ensure that Storage accounts disallow public access"
	FAILED for resource: module.functionapp-dev.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20
	Calling File: /terraform/functionapp/main.tf:4-9
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access.html

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV_AZURE_35: "Ensure default network access rule for Storage Accounts is set to deny"
	FAILED for resource: module.functionapp-test.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20
	Calling File: /terraform/functionapp/main.tf:11-18
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/set-default-network-access-rule-for-storage-accounts-to-deny.html

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV_AZURE_190: "Ensure that Storage blobs restrict public access"
	FAILED for resource: module.functionapp-test.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20
	Calling File: /terraform/functionapp/main.tf:11-18

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV_AZURE_206: "Ensure that Storage Accounts use replication"
	FAILED for resource: module.functionapp-test.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20
	Calling File: /terraform/functionapp/main.tf:11-18

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV_AZURE_33: "Ensure Storage logging is enabled for Queue service for read, write and delete requests"
	FAILED for resource: module.functionapp-test.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20
	Calling File: /terraform/functionapp/main.tf:11-18
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/enable-requests-on-storage-logging-for-queue-service.html

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV_AZURE_59: "Ensure that Storage accounts disallow public access"
	FAILED for resource: module.functionapp-test.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20
	Calling File: /terraform/functionapp/main.tf:11-18
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access.html

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV_AZURE_212: "Ensure App Service has a minimum number of instances for failover"
	FAILED for resource: azurerm_service_plan.plan
	File: /terraform/insecure/appservice/main.tf:10-17

		10 | resource "azurerm_service_plan" "plan" {
		11 |   location            = azurerm_resource_group.rg.location
		12 |   name                = "tf-insecure-app01-plan"
		13 |   os_type             = "Linux"
		14 |   resource_group_name = azurerm_resource_group.rg.name
		15 |   sku_name            = "F1"
		16 | 
		17 | }

Check: CKV_AZURE_211: "Ensure App Service plan suitable for production use"
	FAILED for resource: azurerm_service_plan.plan
	File: /terraform/insecure/appservice/main.tf:10-17

		10 | resource "azurerm_service_plan" "plan" {
		11 |   location            = azurerm_resource_group.rg.location
		12 |   name                = "tf-insecure-app01-plan"
		13 |   os_type             = "Linux"
		14 |   resource_group_name = azurerm_resource_group.rg.name
		15 |   sku_name            = "F1"
		16 | 
		17 | }

Check: CKV_AZURE_17: "Ensure the web app has 'Client Certificates (Incoming client certificates)' set"
	FAILED for resource: azurerm_app_service.app
	File: /terraform/insecure/appservice/main.tf:20-28
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-7.html

		20 | resource "azurerm_app_service" "app" {
		21 |   location            = azurerm_resource_group.rg.location
		22 |   name                = "tf-insecure-app01-as"
		23 |   resource_group_name = azurerm_resource_group.rg.name
		24 |   service_plan_id     = azurerm_service_plan.plan.id
		25 |   site_config {
		26 |   }
		27 | 
		28 | }

Check: CKV_AZURE_16: "Ensure that Register with Azure Active Directory is enabled on App Service"
	FAILED for resource: azurerm_app_service.app
	File: /terraform/insecure/appservice/main.tf:20-28
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-iam-policies/bc-azr-iam-1.html

		20 | resource "azurerm_app_service" "app" {
		21 |   location            = azurerm_resource_group.rg.location
		22 |   name                = "tf-insecure-app01-as"
		23 |   resource_group_name = azurerm_resource_group.rg.name
		24 |   service_plan_id     = azurerm_service_plan.plan.id
		25 |   site_config {
		26 |   }
		27 | 
		28 | }

Check: CKV_AZURE_66: "Ensure that App service enables failed request tracing"
	FAILED for resource: azurerm_app_service.app
	File: /terraform/insecure/appservice/main.tf:20-28
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/ensure-that-app-service-enables-failed-request-tracing.html

		20 | resource "azurerm_app_service" "app" {
		21 |   location            = azurerm_resource_group.rg.location
		22 |   name                = "tf-insecure-app01-as"
		23 |   resource_group_name = azurerm_resource_group.rg.name
		24 |   service_plan_id     = azurerm_service_plan.plan.id
		25 |   site_config {
		26 |   }
		27 | 
		28 | }

Check: CKV_AZURE_18: "Ensure that 'HTTP Version' is the latest if used to run the web app"
	FAILED for resource: azurerm_app_service.app
	File: /terraform/insecure/appservice/main.tf:20-28
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-8.html

		20 | resource "azurerm_app_service" "app" {
		21 |   location            = azurerm_resource_group.rg.location
		22 |   name                = "tf-insecure-app01-as"
		23 |   resource_group_name = azurerm_resource_group.rg.name
		24 |   service_plan_id     = azurerm_service_plan.plan.id
		25 |   site_config {
		26 |   }
		27 | 
		28 | }

Check: CKV_AZURE_65: "Ensure that App service enables detailed error messages"
	FAILED for resource: azurerm_app_service.app
	File: /terraform/insecure/appservice/main.tf:20-28
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/tbdensure-that-app-service-enables-detailed-error-messages.html

		20 | resource "azurerm_app_service" "app" {
		21 |   location            = azurerm_resource_group.rg.location
		22 |   name                = "tf-insecure-app01-as"
		23 |   resource_group_name = azurerm_resource_group.rg.name
		24 |   service_plan_id     = azurerm_service_plan.plan.id
		25 |   site_config {
		26 |   }
		27 | 
		28 | }

Check: CKV_AZURE_71: "Ensure that Managed identity provider is enabled for app services"
	FAILED for resource: azurerm_app_service.app
	File: /terraform/insecure/appservice/main.tf:20-28
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-managed-identity-provider-is-enabled-for-app-services.html

		20 | resource "azurerm_app_service" "app" {
		21 |   location            = azurerm_resource_group.rg.location
		22 |   name                = "tf-insecure-app01-as"
		23 |   resource_group_name = azurerm_resource_group.rg.name
		24 |   service_plan_id     = azurerm_service_plan.plan.id
		25 |   site_config {
		26 |   }
		27 | 
		28 | }

Check: CKV_AZURE_88: "Ensure that app services use Azure Files"
	FAILED for resource: azurerm_app_service.app
	File: /terraform/insecure/appservice/main.tf:20-28
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-app-services-use-azure-files.html

		20 | resource "azurerm_app_service" "app" {
		21 |   location            = azurerm_resource_group.rg.location
		22 |   name                = "tf-insecure-app01-as"
		23 |   resource_group_name = azurerm_resource_group.rg.name
		24 |   service_plan_id     = azurerm_service_plan.plan.id
		25 |   site_config {
		26 |   }
		27 | 
		28 | }

Check: CKV_AZURE_13: "Ensure App Service Authentication is set on Azure App Service"
	FAILED for resource: azurerm_app_service.app
	File: /terraform/insecure/appservice/main.tf:20-28
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-2.html

		20 | resource "azurerm_app_service" "app" {
		21 |   location            = azurerm_resource_group.rg.location
		22 |   name                = "tf-insecure-app01-as"
		23 |   resource_group_name = azurerm_resource_group.rg.name
		24 |   service_plan_id     = azurerm_service_plan.plan.id
		25 |   site_config {
		26 |   }
		27 | 
		28 | }

Check: CKV_AZURE_213: "Ensure that App Service configures health check"
	FAILED for resource: azurerm_app_service.app
	File: /terraform/insecure/appservice/main.tf:20-28

		20 | resource "azurerm_app_service" "app" {
		21 |   location            = azurerm_resource_group.rg.location
		22 |   name                = "tf-insecure-app01-as"
		23 |   resource_group_name = azurerm_resource_group.rg.name
		24 |   service_plan_id     = azurerm_service_plan.plan.id
		25 |   site_config {
		26 |   }
		27 | 
		28 | }

Check: CKV_AZURE_78: "Ensure FTP deployments are disabled"
	FAILED for resource: azurerm_app_service.app
	File: /terraform/insecure/appservice/main.tf:20-28
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-ftp-deployments-are-disabled.html

		20 | resource "azurerm_app_service" "app" {
		21 |   location            = azurerm_resource_group.rg.location
		22 |   name                = "tf-insecure-app01-as"
		23 |   resource_group_name = azurerm_resource_group.rg.name
		24 |   service_plan_id     = azurerm_service_plan.plan.id
		25 |   site_config {
		26 |   }
		27 | 
		28 | }

Check: CKV_AZURE_63: "Ensure that App service enables HTTP logging"
	FAILED for resource: azurerm_app_service.app
	File: /terraform/insecure/appservice/main.tf:20-28
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/ensure-that-app-service-enables-http-logging.html

		20 | resource "azurerm_app_service" "app" {
		21 |   location            = azurerm_resource_group.rg.location
		22 |   name                = "tf-insecure-app01-as"
		23 |   resource_group_name = azurerm_resource_group.rg.name
		24 |   service_plan_id     = azurerm_service_plan.plan.id
		25 |   site_config {
		26 |   }
		27 | 
		28 | }

Check: CKV_AZURE_14: "Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service"
	FAILED for resource: azurerm_app_service.app
	File: /terraform/insecure/appservice/main.tf:20-28
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-5.html

		20 | resource "azurerm_app_service" "app" {
		21 |   location            = azurerm_resource_group.rg.location
		22 |   name                = "tf-insecure-app01-as"
		23 |   resource_group_name = azurerm_resource_group.rg.name
		24 |   service_plan_id     = azurerm_service_plan.plan.id
		25 |   site_config {
		26 |   }
		27 | 
		28 | }

Check: CKV_AZURE_189: "Ensure that Azure Key Vault disables public network access"
	FAILED for resource: azurerm_key_vault.example
	File: /terraform/insecure/keyvault/main.tf:19-46

		19 | resource "azurerm_key_vault" "example" {
		20 |   name                        = "examplekeyvault"
		21 |   location                    = azurerm_resource_group.rg.location
		22 |   resource_group_name         = azurerm_resource_group.rg.name
		23 |   enabled_for_disk_encryption = true
		24 |   tenant_id                   = data.azurerm_client_config.current.tenant_id
		25 |   soft_delete_retention_days  = 7
		26 |   purge_protection_enabled    = false
		27 | 
		28 |   sku_name = "standard"
		29 | 
		30 |   access_policy {
		31 |     tenant_id = data.azurerm_client_config.current.tenant_id
		32 |     object_id = data.azurerm_client_config.current.object_id
		33 | 
		34 |     key_permissions = [
		35 |       "Get",
		36 |     ]
		37 | 
		38 |     secret_permissions = [
		39 |       "Get",
		40 |     ]
		41 | 
		42 |     storage_permissions = [
		43 |       "Get",
		44 |     ]
		45 |   }
		46 | }

Check: CKV_AZURE_109: "Ensure that key vault allows firewall rules settings"
	FAILED for resource: azurerm_key_vault.example
	File: /terraform/insecure/keyvault/main.tf:19-46
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-key-vault-allows-firewall-rules-settings.html

		19 | resource "azurerm_key_vault" "example" {
		20 |   name                        = "examplekeyvault"
		21 |   location                    = azurerm_resource_group.rg.location
		22 |   resource_group_name         = azurerm_resource_group.rg.name
		23 |   enabled_for_disk_encryption = true
		24 |   tenant_id                   = data.azurerm_client_config.current.tenant_id
		25 |   soft_delete_retention_days  = 7
		26 |   purge_protection_enabled    = false
		27 | 
		28 |   sku_name = "standard"
		29 | 
		30 |   access_policy {
		31 |     tenant_id = data.azurerm_client_config.current.tenant_id
		32 |     object_id = data.azurerm_client_config.current.object_id
		33 | 
		34 |     key_permissions = [
		35 |       "Get",
		36 |     ]
		37 | 
		38 |     secret_permissions = [
		39 |       "Get",
		40 |     ]
		41 | 
		42 |     storage_permissions = [
		43 |       "Get",
		44 |     ]
		45 |   }
		46 | }

Check: CKV_AZURE_110: "Ensure that key vault enables purge protection"
	FAILED for resource: azurerm_key_vault.example
	File: /terraform/insecure/keyvault/main.tf:19-46
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-enables-purge-protection.html

		19 | resource "azurerm_key_vault" "example" {
		20 |   name                        = "examplekeyvault"
		21 |   location                    = azurerm_resource_group.rg.location
		22 |   resource_group_name         = azurerm_resource_group.rg.name
		23 |   enabled_for_disk_encryption = true
		24 |   tenant_id                   = data.azurerm_client_config.current.tenant_id
		25 |   soft_delete_retention_days  = 7
		26 |   purge_protection_enabled    = false
		27 | 
		28 |   sku_name = "standard"
		29 | 
		30 |   access_policy {
		31 |     tenant_id = data.azurerm_client_config.current.tenant_id
		32 |     object_id = data.azurerm_client_config.current.object_id
		33 | 
		34 |     key_permissions = [
		35 |       "Get",
		36 |     ]
		37 | 
		38 |     secret_permissions = [
		39 |       "Get",
		40 |     ]
		41 | 
		42 |     storage_permissions = [
		43 |       "Get",
		44 |     ]
		45 |   }
		46 | }

Check: CKV_AZURE_42: "Ensure the key vault is recoverable"
	FAILED for resource: azurerm_key_vault.example
	File: /terraform/insecure/keyvault/main.tf:19-46
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-the-key-vault-is-recoverable.html

		19 | resource "azurerm_key_vault" "example" {
		20 |   name                        = "examplekeyvault"
		21 |   location                    = azurerm_resource_group.rg.location
		22 |   resource_group_name         = azurerm_resource_group.rg.name
		23 |   enabled_for_disk_encryption = true
		24 |   tenant_id                   = data.azurerm_client_config.current.tenant_id
		25 |   soft_delete_retention_days  = 7
		26 |   purge_protection_enabled    = false
		27 | 
		28 |   sku_name = "standard"
		29 | 
		30 |   access_policy {
		31 |     tenant_id = data.azurerm_client_config.current.tenant_id
		32 |     object_id = data.azurerm_client_config.current.object_id
		33 | 
		34 |     key_permissions = [
		35 |       "Get",
		36 |     ]
		37 | 
		38 |     secret_permissions = [
		39 |       "Get",
		40 |     ]
		41 | 
		42 |     storage_permissions = [
		43 |       "Get",
		44 |     ]
		45 |   }
		46 | }

Check: CKV_AZURE_114: "Ensure that key vault secrets have "content_type" set"
	FAILED for resource: azurerm_key_vault_secret.bad_example
	File: /terraform/insecure/keyvault/main.tf:48-52
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-secrets-have-content-type-set.html

		48 | resource "azurerm_key_vault_secret" "bad_example" {
		49 |   name         = "secret-sauce"
		50 |   value        = "szechuan"
		51 |   key_vault_id = azurerm_key_vault.example.id
		52 | }

Check: CKV_AZURE_41: "Ensure that the expiration date is set on all secrets"
	FAILED for resource: azurerm_key_vault_secret.bad_example
	File: /terraform/insecure/keyvault/main.tf:48-52
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-secrets-policies/set-an-expiration-date-on-all-secrets.html

		48 | resource "azurerm_key_vault_secret" "bad_example" {
		49 |   name         = "secret-sauce"
		50 |   value        = "szechuan"
		51 |   key_vault_id = azurerm_key_vault.example.id
		52 | }

Check: CKV_AZURE_39: "Ensure that no custom subscription owner roles are created"
	FAILED for resource: azurerm_role_definition.example
	File: /terraform/insecure/role/main.tf:13-26
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-iam-policies/do-not-create-custom-subscription-owner-roles.html

		13 | resource "azurerm_role_definition" "example" {
		14 |   name        = "my-custom-role"
		15 |   scope       = data.azurerm_subscription.primary.id
		16 |   description = "This is a custom role created via Terraform"
		17 | 
		18 |   permissions {
		19 |     actions     = ["*"]
		20 |     not_actions = []
		21 |   }
		22 | 
		23 |   assignable_scopes = [
		24 |     "/"
		25 |   ]
		26 | }

Check: CKV_AZURE_160: "Ensure that HTTP (port 80) access is restricted from the internet"
	FAILED for resource: azurerm_network_security_group.nsg
	File: /terraform/insecure/vm/main.tf:45-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-azure-http-port-80-access-from-the-internet-is-restricted.html

		45 | resource "azurerm_network_security_group" "nsg" {
		46 |   location            = azurerm_resource_group.rg.location
		47 |   name                = "value"
		48 |   resource_group_name = azurerm_resource_group.rg.name
		49 | 
		50 |   security_rule {
		51 |     name                       = "test123"
		52 |     priority                   = 100
		53 |     direction                  = "Inbound"
		54 |     access                     = "Allow"
		55 |     protocol                   = "Tcp"
		56 |     source_port_range          = "*"
		57 |     destination_port_range     = "*"
		58 |     source_address_prefix      = "*"
		59 |     destination_address_prefix = "*"
		60 |   }
		61 | }

Check: CKV_AZURE_10: "Ensure that SSH access is restricted from the internet"
	FAILED for resource: azurerm_network_security_group.nsg
	File: /terraform/insecure/vm/main.tf:45-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-3.html

		45 | resource "azurerm_network_security_group" "nsg" {
		46 |   location            = azurerm_resource_group.rg.location
		47 |   name                = "value"
		48 |   resource_group_name = azurerm_resource_group.rg.name
		49 | 
		50 |   security_rule {
		51 |     name                       = "test123"
		52 |     priority                   = 100
		53 |     direction                  = "Inbound"
		54 |     access                     = "Allow"
		55 |     protocol                   = "Tcp"
		56 |     source_port_range          = "*"
		57 |     destination_port_range     = "*"
		58 |     source_address_prefix      = "*"
		59 |     destination_address_prefix = "*"
		60 |   }
		61 | }

Check: CKV_AZURE_9: "Ensure that RDP access is restricted from the internet"
	FAILED for resource: azurerm_network_security_group.nsg
	File: /terraform/insecure/vm/main.tf:45-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-2.html

		45 | resource "azurerm_network_security_group" "nsg" {
		46 |   location            = azurerm_resource_group.rg.location
		47 |   name                = "value"
		48 |   resource_group_name = azurerm_resource_group.rg.name
		49 | 
		50 |   security_rule {
		51 |     name                       = "test123"
		52 |     priority                   = 100
		53 |     direction                  = "Inbound"
		54 |     access                     = "Allow"
		55 |     protocol                   = "Tcp"
		56 |     source_port_range          = "*"
		57 |     destination_port_range     = "*"
		58 |     source_address_prefix      = "*"
		59 |     destination_address_prefix = "*"
		60 |   }
		61 | }

Check: CKV_AZURE_151: "Ensure Windows VM enables encryption"
	FAILED for resource: azurerm_windows_virtual_machine.vm1
	File: /terraform/insecure/vm/main.tf:63-85
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-iam-policies/ensure-azure-windows-vm-enables-encryption.html

		63 | resource "azurerm_windows_virtual_machine" "vm1" {
		64 |   name                = "tf-insecure-vm1"
		65 |   resource_group_name = azurerm_resource_group.rg.name
		66 |   location            = azurerm_resource_group.rg.location
		67 |   size                = "Standard_B2s"
		68 |   admin_username      = "administrator"
		69 |   admin_password      = "P@$$w0rd1234!"
		70 |   network_interface_ids = [
		71 |     azurerm_network_interface.vm1_nic.id,
		72 |   ]
		73 | 
		74 |   os_disk {
		75 |     caching              = "ReadWrite"
		76 |     storage_account_type = "Standard_LRS"
		77 |   }
		78 | 
		79 |   source_image_reference {
		80 |     publisher = "MicrosoftWindowsServer"
		81 |     offer     = "WindowsServer"
		82 |     sku       = "2022-Datacenter"
		83 |     version   = "latest"
		84 |   }
		85 | }

Check: CKV_AZURE_50: "Ensure Virtual Machine Extensions are not Installed"
	FAILED for resource: azurerm_windows_virtual_machine.vm1
	File: /terraform/insecure/vm/main.tf:63-85
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-14.html

		63 | resource "azurerm_windows_virtual_machine" "vm1" {
		64 |   name                = "tf-insecure-vm1"
		65 |   resource_group_name = azurerm_resource_group.rg.name
		66 |   location            = azurerm_resource_group.rg.location
		67 |   size                = "Standard_B2s"
		68 |   admin_username      = "administrator"
		69 |   admin_password      = "P@$$w0rd1234!"
		70 |   network_interface_ids = [
		71 |     azurerm_network_interface.vm1_nic.id,
		72 |   ]
		73 | 
		74 |   os_disk {
		75 |     caching              = "ReadWrite"
		76 |     storage_account_type = "Standard_LRS"
		77 |   }
		78 | 
		79 |   source_image_reference {
		80 |     publisher = "MicrosoftWindowsServer"
		81 |     offer     = "WindowsServer"
		82 |     sku       = "2022-Datacenter"
		83 |     version   = "latest"
		84 |   }
		85 | }

Check: CKV_AZURE_44: "Ensure Storage Account is using the latest version of TLS encryption"
	FAILED for resource: azurerm_storage_account.logicapp_std_storage
	File: /terraform/logicapp/main.tf:45-51
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-storage-policies/bc-azr-storage-2.html

		45 | resource "azurerm_storage_account" "logicapp_std_storage" {
		46 |   name                     = "${var.context_prefix}${random_string.unique.result}${var.environment_name}sa"
		47 |   resource_group_name      = azurerm_resource_group.rg.name
		48 |   location                 = azurerm_resource_group.rg.location
		49 |   account_tier             = "Standard"
		50 |   account_replication_type = "LRS"
		51 | }

Check: CKV_AZURE_190: "Ensure that Storage blobs restrict public access"
	FAILED for resource: azurerm_storage_account.logicapp_std_storage
	File: /terraform/logicapp/main.tf:45-51

		45 | resource "azurerm_storage_account" "logicapp_std_storage" {
		46 |   name                     = "${var.context_prefix}${random_string.unique.result}${var.environment_name}sa"
		47 |   resource_group_name      = azurerm_resource_group.rg.name
		48 |   location                 = azurerm_resource_group.rg.location
		49 |   account_tier             = "Standard"
		50 |   account_replication_type = "LRS"
		51 | }

Check: CKV_AZURE_206: "Ensure that Storage Accounts use replication"
	FAILED for resource: azurerm_storage_account.logicapp_std_storage
	File: /terraform/logicapp/main.tf:45-51

		45 | resource "azurerm_storage_account" "logicapp_std_storage" {
		46 |   name                     = "${var.context_prefix}${random_string.unique.result}${var.environment_name}sa"
		47 |   resource_group_name      = azurerm_resource_group.rg.name
		48 |   location                 = azurerm_resource_group.rg.location
		49 |   account_tier             = "Standard"
		50 |   account_replication_type = "LRS"
		51 | }

Check: CKV_AZURE_33: "Ensure Storage logging is enabled for Queue service for read, write and delete requests"
	FAILED for resource: azurerm_storage_account.logicapp_std_storage
	File: /terraform/logicapp/main.tf:45-51
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/enable-requests-on-storage-logging-for-queue-service.html

		45 | resource "azurerm_storage_account" "logicapp_std_storage" {
		46 |   name                     = "${var.context_prefix}${random_string.unique.result}${var.environment_name}sa"
		47 |   resource_group_name      = azurerm_resource_group.rg.name
		48 |   location                 = azurerm_resource_group.rg.location
		49 |   account_tier             = "Standard"
		50 |   account_replication_type = "LRS"
		51 | }

Check: CKV_AZURE_59: "Ensure that Storage accounts disallow public access"
	FAILED for resource: azurerm_storage_account.logicapp_std_storage
	File: /terraform/logicapp/main.tf:45-51
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access.html

		45 | resource "azurerm_storage_account" "logicapp_std_storage" {
		46 |   name                     = "${var.context_prefix}${random_string.unique.result}${var.environment_name}sa"
		47 |   resource_group_name      = azurerm_resource_group.rg.name
		48 |   location                 = azurerm_resource_group.rg.location
		49 |   account_tier             = "Standard"
		50 |   account_replication_type = "LRS"
		51 | }

Check: CKV_AZURE_212: "Ensure App Service has a minimum number of instances for failover"
	FAILED for resource: azurerm_service_plan.platform_logicapp_plan
	File: /terraform/logicapp/main.tf:54-62

		54 | resource "azurerm_service_plan" "platform_logicapp_plan" {
		55 |   name                = "${var.context_prefix}-${random_string.unique.result}-${var.environment_name}-plan"
		56 |   location            = azurerm_resource_group.rg.location
		57 |   resource_group_name = azurerm_resource_group.rg.name
		58 |   #kind                = "elastic"
		59 |   os_type  = "Windows"
		60 |   tags     = {}
		61 |   sku_name = "WS1"
		62 | }

Check: CKV_AZURE_206: "Ensure that Storage Accounts use replication"
	FAILED for resource: azurerm_storage_account.storeacc
	File: /terraform/moved-block/main.tf:22-32

		22 | resource "azurerm_storage_account" "storeacc" {
		23 |   name                            = "simplestoragetorivar"
		24 |   resource_group_name             = azurerm_resource_group.rg.name
		25 |   location                        = "norwayeast"
		26 |   account_kind                    = "StorageV2"
		27 |   account_tier                    = "Standard"
		28 |   account_replication_type        = "LRS"
		29 |   enable_https_traffic_only       = true
		30 |   allow_nested_items_to_be_public = false
		31 |   min_tls_version                 = "TLS1_2"
		32 | }

Check: CKV_AZURE_33: "Ensure Storage logging is enabled for Queue service for read, write and delete requests"
	FAILED for resource: azurerm_storage_account.storeacc
	File: /terraform/moved-block/main.tf:22-32
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/enable-requests-on-storage-logging-for-queue-service.html

		22 | resource "azurerm_storage_account" "storeacc" {
		23 |   name                            = "simplestoragetorivar"
		24 |   resource_group_name             = azurerm_resource_group.rg.name
		25 |   location                        = "norwayeast"
		26 |   account_kind                    = "StorageV2"
		27 |   account_tier                    = "Standard"
		28 |   account_replication_type        = "LRS"
		29 |   enable_https_traffic_only       = true
		30 |   allow_nested_items_to_be_public = false
		31 |   min_tls_version                 = "TLS1_2"
		32 | }

Check: CKV_AZURE_59: "Ensure that Storage accounts disallow public access"
	FAILED for resource: azurerm_storage_account.storeacc
	File: /terraform/moved-block/main.tf:22-32
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access.html

		22 | resource "azurerm_storage_account" "storeacc" {
		23 |   name                            = "simplestoragetorivar"
		24 |   resource_group_name             = azurerm_resource_group.rg.name
		25 |   location                        = "norwayeast"
		26 |   account_kind                    = "StorageV2"
		27 |   account_tier                    = "Standard"
		28 |   account_replication_type        = "LRS"
		29 |   enable_https_traffic_only       = true
		30 |   allow_nested_items_to_be_public = false
		31 |   min_tls_version                 = "TLS1_2"
		32 | }

Check: CKV_AZURE_44: "Ensure Storage Account is using the latest version of TLS encryption"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg1"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-storage-policies/bc-azr-storage-2.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_190: "Ensure that Storage blobs restrict public access"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg1"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_206: "Ensure that Storage Accounts use replication"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg1"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_59: "Ensure that Storage accounts disallow public access"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg1"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_44: "Ensure Storage Account is using the latest version of TLS encryption"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg2"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-storage-policies/bc-azr-storage-2.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_190: "Ensure that Storage blobs restrict public access"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg2"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_206: "Ensure that Storage Accounts use replication"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg2"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_59: "Ensure that Storage accounts disallow public access"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg2"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_44: "Ensure Storage Account is using the latest version of TLS encryption"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg3"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-storage-policies/bc-azr-storage-2.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_190: "Ensure that Storage blobs restrict public access"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg3"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_206: "Ensure that Storage Accounts use replication"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg3"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_59: "Ensure that Storage accounts disallow public access"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg3"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_44: "Ensure Storage Account is using the latest version of TLS encryption"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg4"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-storage-policies/bc-azr-storage-2.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_190: "Ensure that Storage blobs restrict public access"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg4"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_206: "Ensure that Storage Accounts use replication"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg4"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_59: "Ensure that Storage accounts disallow public access"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg4"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_44: "Ensure Storage Account is using the latest version of TLS encryption"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg5"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-storage-policies/bc-azr-storage-2.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_190: "Ensure that Storage blobs restrict public access"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg5"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_206: "Ensure that Storage Accounts use replication"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg5"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_59: "Ensure that Storage accounts disallow public access"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg5"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Calling File: /terraform/optional-testing/main.tf:26-61
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV_AZURE_212: "Ensure App Service has a minimum number of instances for failover"
	FAILED for resource: azurerm_service_plan.plan
	File: /terraform/tf-testing/service-plan/main.tf:29-35

		29 | resource "azurerm_service_plan" "plan" {
		30 |   location            = azurerm_resource_group.rg.location
		31 |   name                = "tf-testing-${random_string.unique.result}-asp"
		32 |   os_type             = "Linux"
		33 |   resource_group_name = azurerm_resource_group.rg.name
		34 |   sku_name            = "F1"
		35 | }

Check: CKV_AZURE_211: "Ensure App Service plan suitable for production use"
	FAILED for resource: azurerm_service_plan.plan
	File: /terraform/tf-testing/service-plan/main.tf:29-35

		29 | resource "azurerm_service_plan" "plan" {
		30 |   location            = azurerm_resource_group.rg.location
		31 |   name                = "tf-testing-${random_string.unique.result}-asp"
		32 |   os_type             = "Linux"
		33 |   resource_group_name = azurerm_resource_group.rg.name
		34 |   sku_name            = "F1"
		35 | }

Check: CKV_AZURE_120: "Ensure that Application Gateway enables WAF"
	FAILED for resource: azurerm_application_gateway.network
	File: /terraform/agic/appgw.tf:19-100
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-application-gateway-enables-waf.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_120: "Ensure that Application Gateway enables WAF"
	FAILED for resource: azurerm_application_gateway.network
	File: /terraform/appgateway/gateway.tf:14-97
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-application-gateway-enables-waf.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV2_AZURE_24: "Ensure Azure automation account does NOT have overly permissive network access"
	FAILED for resource: azurerm_automation_account.aa
	File: /terraform/automationaccount/main.tf:18-23

		18 | resource "azurerm_automation_account" "aa" {
		19 |   name                = "${var.prefix}-aa"
		20 |   location            = azurerm_resource_group.rg.location
		21 |   resource_group_name = azurerm_resource_group.rg.name
		22 |   sku_name            = "Basic"
		23 | }

Check: CKV2_AZURE_31: "Ensure VNET subnet is configured with a Network Security Group (NSG)"
	FAILED for resource: azurerm_subnet.kubesubnet
	File: /terraform/agic/network.tf:9-14

		9  | resource "azurerm_subnet" "kubesubnet" {
		10 |   name                 = var.aks_subnet_name
		11 |   address_prefixes     = [var.aks_subnet_address_prefix]
		12 |   virtual_network_name = azurerm_virtual_network.test.name
		13 |   resource_group_name  = azurerm_resource_group.rg.name
		14 | }

Check: CKV2_AZURE_31: "Ensure VNET subnet is configured with a Network Security Group (NSG)"
	FAILED for resource: azurerm_subnet.appgwsubnet
	File: /terraform/agic/network.tf:16-21

		16 | resource "azurerm_subnet" "appgwsubnet" {
		17 |   name                 = "appgwsubnet"
		18 |   address_prefixes     = [var.app_gateway_subnet_address_prefix]
		19 |   virtual_network_name = azurerm_virtual_network.test.name
		20 |   resource_group_name  = azurerm_resource_group.rg.name
		21 | }

Check: CKV2_AZURE_31: "Ensure VNET subnet is configured with a Network Security Group (NSG)"
	FAILED for resource: azurerm_subnet.mgmtsubnet
	File: /terraform/agic/network.tf:23-28

		23 | resource "azurerm_subnet" "mgmtsubnet" {
		24 |   name                 = "mgmtsubnet"
		25 |   address_prefixes     = ["192.168.2.0/24"]
		26 |   virtual_network_name = azurerm_virtual_network.test.name
		27 |   resource_group_name  = azurerm_resource_group.rg.name
		28 | }

Check: CKV2_AZURE_31: "Ensure VNET subnet is configured with a Network Security Group (NSG)"
	FAILED for resource: azurerm_subnet.example[0]
	File: /terraform/appgateway/network.tf:20-26

		20 | resource "azurerm_subnet" "example" {
		21 |   count                = length(keys(local.subnets))
		22 |   name                 = keys(local.subnets)[count.index]
		23 |   resource_group_name  = azurerm_resource_group.example.name
		24 |   virtual_network_name = azurerm_virtual_network.example.name
		25 |   address_prefixes     = [local.subnets[keys(local.subnets)[count.index]]]
		26 | }

Check: CKV2_AZURE_31: "Ensure VNET subnet is configured with a Network Security Group (NSG)"
	FAILED for resource: module.functionapp-dev.azurerm_subnet.integration-subnet
	File: /terraform/functionapp/modules/app/network.tf:9-15

		9  | resource "azurerm_subnet" "integration-subnet" {
		10 |   count                = var.vnet_integration_enabled == true && var.vnet_integration_subnet_id == null ? 1 : 0
		11 |   address_prefixes     = ["10.0.0.0/25"]
		12 |   name                 = "integrationSubnet"
		13 |   resource_group_name  = azurerm_resource_group.rg.name
		14 |   virtual_network_name = azurerm_virtual_network.integration-vnet[0].name
		15 | }

Check: CKV2_AZURE_31: "Ensure VNET subnet is configured with a Network Security Group (NSG)"
	FAILED for resource: module.functionapp-test.azurerm_subnet.integration-subnet
	File: /terraform/functionapp/modules/app/network.tf:9-15

		9  | resource "azurerm_subnet" "integration-subnet" {
		10 |   count                = var.vnet_integration_enabled == true && var.vnet_integration_subnet_id == null ? 1 : 0
		11 |   address_prefixes     = ["10.0.0.0/25"]
		12 |   name                 = "integrationSubnet"
		13 |   resource_group_name  = azurerm_resource_group.rg.name
		14 |   virtual_network_name = azurerm_virtual_network.integration-vnet[0].name
		15 | }

Check: CKV2_AZURE_31: "Ensure VNET subnet is configured with a Network Security Group (NSG)"
	FAILED for resource: azurerm_subnet.subnet1
	File: /terraform/insecure/vm/main.tf:17-22

		17 | resource "azurerm_subnet" "subnet1" {
		18 |   name                 = "subnet1"
		19 |   resource_group_name  = azurerm_resource_group.rg.name
		20 |   virtual_network_name = azurerm_virtual_network.vnet.name
		21 |   address_prefixes     = ["10.0.0.0/24"]
		22 | }

Check: CKV2_AZURE_31: "Ensure VNET subnet is configured with a Network Security Group (NSG)"
	FAILED for resource: azurerm_subnet.subnet1
	File: /terraform/tf-testing/service-plan/main.tf:44-49

		44 | resource "azurerm_subnet" "subnet1" {
		45 |   address_prefixes     = ["10.0.0.0/24"]
		46 |   name                 = "subnet1"
		47 |   resource_group_name  = azurerm_resource_group.rg.name
		48 |   virtual_network_name = azurerm_virtual_network.vnet.name
		49 | }

Check: CKV2_AZURE_31: "Ensure VNET subnet is configured with a Network Security Group (NSG)"
	FAILED for resource: azurerm_subnet.subnet1
	File: /terraform/vnet-testing/main.tf:15-24

		15 | resource "azurerm_subnet" "subnet1" {
		16 |   address_prefixes     = ["10.0.0.0/24"]
		17 |   name                 = "subnet1"
		18 |   resource_group_name  = azurerm_resource_group.rg.name
		19 |   virtual_network_name = azurerm_virtual_network.vnet.name
		20 | 
		21 |   enforce_private_link_endpoint_network_policies = true
		22 |   enforce_private_link_service_network_policies  = false
		23 | 
		24 | }

Check: CKV2_AZURE_31: "Ensure VNET subnet is configured with a Network Security Group (NSG)"
	FAILED for resource: azurerm_subnet.subnet2
	File: /terraform/vnet-testing/main.tf:26-35

		26 | resource "azurerm_subnet" "subnet2" {
		27 |   address_prefixes     = ["10.0.1.0/24"]
		28 |   name                 = "subnet2"
		29 |   resource_group_name  = azurerm_resource_group.rg.name
		30 |   virtual_network_name = azurerm_virtual_network.vnet.name
		31 | 
		32 |   private_endpoint_network_policies_enabled     = false
		33 |   private_link_service_network_policies_enabled = true
		34 | 
		35 | }

Check: CKV_AZURE_119: "Ensure that Network Interfaces don't use public IPs"
	FAILED for resource: azurerm_network_interface.jumpbox
	File: /terraform/agic/jumpbox.tf:28-40
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-network-interfaces-dont-use-public-ips.html

		28 | resource "azurerm_network_interface" "jumpbox" {
		29 |   name                = "jumpbox-nic"
		30 |   location            = azurerm_resource_group.rg.location
		31 |   resource_group_name = azurerm_resource_group.rg.name
		32 | 
		33 | 
		34 |   ip_configuration {
		35 |     name                          = "internal"
		36 |     subnet_id                     = resource.azurerm_subnet.mgmtsubnet.id
		37 |     private_ip_address_allocation = "Dynamic"
		38 |     public_ip_address_id          = azurerm_public_ip.pip.id
		39 |   }
		40 | }

Check: CKV_AZURE_119: "Ensure that Network Interfaces don't use public IPs"
	FAILED for resource: azurerm_network_interface.vm1_nic
	File: /terraform/insecure/vm/main.tf:24-35
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-network-interfaces-dont-use-public-ips.html

		24 | resource "azurerm_network_interface" "vm1_nic" {
		25 |   name                = "tf-insecure-vm1-nic1"
		26 |   location            = azurerm_resource_group.rg.location
		27 |   resource_group_name = azurerm_resource_group.rg.name
		28 | 
		29 |   ip_configuration {
		30 |     name                          = "internal"
		31 |     subnet_id                     = azurerm_subnet.subnet1.id
		32 |     private_ip_address_allocation = "Dynamic"
		33 |     public_ip_address_id          = azurerm_public_ip.pip.id
		34 |   }
		35 | }

Check: CKV2_AZURE_33: "Ensure storage account is configured with private endpoint"
	FAILED for resource: module.functionapp-dev.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV2_AZURE_33: "Ensure storage account is configured with private endpoint"
	FAILED for resource: module.functionapp-test.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV2_AZURE_33: "Ensure storage account is configured with private endpoint"
	FAILED for resource: azurerm_storage_account.logicapp_std_storage
	File: /terraform/logicapp/main.tf:45-51

		45 | resource "azurerm_storage_account" "logicapp_std_storage" {
		46 |   name                     = "${var.context_prefix}${random_string.unique.result}${var.environment_name}sa"
		47 |   resource_group_name      = azurerm_resource_group.rg.name
		48 |   location                 = azurerm_resource_group.rg.location
		49 |   account_tier             = "Standard"
		50 |   account_replication_type = "LRS"
		51 | }

Check: CKV2_AZURE_33: "Ensure storage account is configured with private endpoint"
	FAILED for resource: azurerm_storage_account.storeacc
	File: /terraform/moved-block/main.tf:22-32

		22 | resource "azurerm_storage_account" "storeacc" {
		23 |   name                            = "simplestoragetorivar"
		24 |   resource_group_name             = azurerm_resource_group.rg.name
		25 |   location                        = "norwayeast"
		26 |   account_kind                    = "StorageV2"
		27 |   account_tier                    = "Standard"
		28 |   account_replication_type        = "LRS"
		29 |   enable_https_traffic_only       = true
		30 |   allow_nested_items_to_be_public = false
		31 |   min_tls_version                 = "TLS1_2"
		32 | }

Check: CKV2_AZURE_33: "Ensure storage account is configured with private endpoint"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg1"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_33: "Ensure storage account is configured with private endpoint"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg2"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_33: "Ensure storage account is configured with private endpoint"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg3"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_33: "Ensure storage account is configured with private endpoint"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg4"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_33: "Ensure storage account is configured with private endpoint"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg5"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: module.functionapp-dev.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key.html

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: module.functionapp-test.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key.html

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: azurerm_storage_account.logicapp_std_storage
	File: /terraform/logicapp/main.tf:45-51
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key.html

		45 | resource "azurerm_storage_account" "logicapp_std_storage" {
		46 |   name                     = "${var.context_prefix}${random_string.unique.result}${var.environment_name}sa"
		47 |   resource_group_name      = azurerm_resource_group.rg.name
		48 |   location                 = azurerm_resource_group.rg.location
		49 |   account_tier             = "Standard"
		50 |   account_replication_type = "LRS"
		51 | }

Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: azurerm_storage_account.storeacc
	File: /terraform/moved-block/main.tf:22-32
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key.html

		22 | resource "azurerm_storage_account" "storeacc" {
		23 |   name                            = "simplestoragetorivar"
		24 |   resource_group_name             = azurerm_resource_group.rg.name
		25 |   location                        = "norwayeast"
		26 |   account_kind                    = "StorageV2"
		27 |   account_tier                    = "Standard"
		28 |   account_replication_type        = "LRS"
		29 |   enable_https_traffic_only       = true
		30 |   allow_nested_items_to_be_public = false
		31 |   min_tls_version                 = "TLS1_2"
		32 | }

Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg1"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg2"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg3"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg4"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg5"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key.html

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_36: "Ensure Azure automation account is configured with managed identity"
	FAILED for resource: azurerm_automation_account.aa
	File: /terraform/automationaccount/main.tf:18-23

		18 | resource "azurerm_automation_account" "aa" {
		19 |   name                = "${var.prefix}-aa"
		20 |   location            = azurerm_resource_group.rg.location
		21 |   resource_group_name = azurerm_resource_group.rg.name
		22 |   sku_name            = "Basic"
		23 | }

Check: CKV2_AZURE_38: "Ensure soft-delete is enabled on Azure storage account"
	FAILED for resource: module.functionapp-dev.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV2_AZURE_38: "Ensure soft-delete is enabled on Azure storage account"
	FAILED for resource: module.functionapp-test.azurerm_storage_account.sa
	File: /terraform/functionapp/modules/app/storage.tf:5-20

		5  | resource "azurerm_storage_account" "sa" {
		6  |   name                      = "${local.name_prefix}${random_string.unique.result}sa"
		7  |   location                  = azurerm_resource_group.rg.location
		8  |   account_replication_type  = "LRS"
		9  |   account_tier              = "Standard"
		10 |   account_kind              = "StorageV2"
		11 |   min_tls_version           = "TLS1_2"
		12 |   enable_https_traffic_only = true
		13 |   resource_group_name       = azurerm_resource_group.rg.name
		14 | 
		15 |   network_rules {
		16 |     default_action             = var.vnet_integration_enabled == false ? "Allow" : "Deny"
		17 |     bypass                     = ["AzureServices"]
		18 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		19 |   }
		20 | }

Check: CKV2_AZURE_38: "Ensure soft-delete is enabled on Azure storage account"
	FAILED for resource: azurerm_storage_account.logicapp_std_storage
	File: /terraform/logicapp/main.tf:45-51

		45 | resource "azurerm_storage_account" "logicapp_std_storage" {
		46 |   name                     = "${var.context_prefix}${random_string.unique.result}${var.environment_name}sa"
		47 |   resource_group_name      = azurerm_resource_group.rg.name
		48 |   location                 = azurerm_resource_group.rg.location
		49 |   account_tier             = "Standard"
		50 |   account_replication_type = "LRS"
		51 | }

Check: CKV2_AZURE_38: "Ensure soft-delete is enabled on Azure storage account"
	FAILED for resource: azurerm_storage_account.storeacc
	File: /terraform/moved-block/main.tf:22-32

		22 | resource "azurerm_storage_account" "storeacc" {
		23 |   name                            = "simplestoragetorivar"
		24 |   resource_group_name             = azurerm_resource_group.rg.name
		25 |   location                        = "norwayeast"
		26 |   account_kind                    = "StorageV2"
		27 |   account_tier                    = "Standard"
		28 |   account_replication_type        = "LRS"
		29 |   enable_https_traffic_only       = true
		30 |   allow_nested_items_to_be_public = false
		31 |   min_tls_version                 = "TLS1_2"
		32 | }

Check: CKV2_AZURE_38: "Ensure soft-delete is enabled on Azure storage account"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg1"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_38: "Ensure soft-delete is enabled on Azure storage account"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg2"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_38: "Ensure soft-delete is enabled on Azure storage account"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg3"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_38: "Ensure soft-delete is enabled on Azure storage account"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg4"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_38: "Ensure soft-delete is enabled on Azure storage account"
	FAILED for resource: module.storage_account.module.storage_accounts.azurerm_storage_account.storeacc["stg5"]
	File: /terraform/optional-testing/modules/storage/main.tf:48-59

		48 | resource "azurerm_storage_account" "storeacc" {
		49 |   for_each                        = var.input
		50 |   name                            = each.value.name
		51 |   resource_group_name             = each.value.resource_group_name != null ? each.value.resource_group_name : local.default_resource_group_name
		52 |   location                        = each.value.location != null ? each.value.location : local.default_location
		53 |   account_kind                    = each.value.account_kind != null ? each.value.account_kind : local.default_account_kind
		54 |   account_tier                    = each.value.account_tier != null ? each.value.account_tier : local.default_account_tier
		55 |   account_replication_type        = each.value.account_replication_type != null ? each.value.account_replication_type : local.default_account_replication_type
		56 |   enable_https_traffic_only       = each.value.enable_https_traffic_only != null ? each.value.enable_https_traffic_only : local.default_enable_https_traffic_only
		57 |   allow_nested_items_to_be_public = each.value.allow_nested_items_to_be_public != null ? each.value.allow_nested_items_to_be_public : local.default_allow_nested_items_to_be_public
		58 |   min_tls_version                 = each.value.min_tls_version != null ? each.value.min_tls_version : local.default_min_tls_version
		59 | }

Check: CKV2_AZURE_32: "Ensure private endpoint is configured to key vault"
	FAILED for resource: module.functionapp-dev.azurerm_key_vault.kv
	File: /terraform/functionapp/modules/app/key_vault.tf:1-17

		1  | resource "azurerm_key_vault" "kv" {
		2  |   location                   = azurerm_resource_group.rg.location
		3  |   name                       = "${local.resource_prefix}-kv"
		4  |   resource_group_name        = azurerm_resource_group.rg.name
		5  |   sku_name                   = "standard"
		6  |   tenant_id                  = data.azurerm_client_config.current.tenant_id
		7  |   enable_rbac_authorization  = true
		8  |   soft_delete_retention_days = 90
		9  | 
		10 |   network_acls {
		11 |     bypass                     = "AzureServices"
		12 |     default_action             = "Deny"
		13 |     ip_rules                   = azurerm_windows_function_app.app.outbound_ip_address_list
		14 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		15 |   }
		16 | 
		17 | }

Check: CKV2_AZURE_32: "Ensure private endpoint is configured to key vault"
	FAILED for resource: module.functionapp-test.azurerm_key_vault.kv
	File: /terraform/functionapp/modules/app/key_vault.tf:1-17

		1  | resource "azurerm_key_vault" "kv" {
		2  |   location                   = azurerm_resource_group.rg.location
		3  |   name                       = "${local.resource_prefix}-kv"
		4  |   resource_group_name        = azurerm_resource_group.rg.name
		5  |   sku_name                   = "standard"
		6  |   tenant_id                  = data.azurerm_client_config.current.tenant_id
		7  |   enable_rbac_authorization  = true
		8  |   soft_delete_retention_days = 90
		9  | 
		10 |   network_acls {
		11 |     bypass                     = "AzureServices"
		12 |     default_action             = "Deny"
		13 |     ip_rules                   = azurerm_windows_function_app.app.outbound_ip_address_list
		14 |     virtual_network_subnet_ids = var.vnet_integration_enabled == false ? [] : [local.virtual_network_subnet_id]
		15 |   }
		16 | 
		17 | }

Check: CKV2_AZURE_32: "Ensure private endpoint is configured to key vault"
	FAILED for resource: azurerm_key_vault.example
	File: /terraform/insecure/keyvault/main.tf:19-46

		19 | resource "azurerm_key_vault" "example" {
		20 |   name                        = "examplekeyvault"
		21 |   location                    = azurerm_resource_group.rg.location
		22 |   resource_group_name         = azurerm_resource_group.rg.name
		23 |   enabled_for_disk_encryption = true
		24 |   tenant_id                   = data.azurerm_client_config.current.tenant_id
		25 |   soft_delete_retention_days  = 7
		26 |   purge_protection_enabled    = false
		27 | 
		28 |   sku_name = "standard"
		29 | 
		30 |   access_policy {
		31 |     tenant_id = data.azurerm_client_config.current.tenant_id
		32 |     object_id = data.azurerm_client_config.current.object_id
		33 | 
		34 |     key_permissions = [
		35 |       "Get",
		36 |     ]
		37 | 
		38 |     secret_permissions = [
		39 |       "Get",
		40 |     ]
		41 | 
		42 |     storage_permissions = [
		43 |       "Get",
		44 |     ]
		45 |   }
		46 | }

kubernetes scan results:

Passed checks: 147, Failed checks: 35, Skipped checks: 0

Check: CKV_K8S_23: "Minimize the admission of root containers"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-22.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_30: "Apply security context to your containers"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-28.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_31: "Ensure that the seccomp profile is set to docker/default or runtime/default"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-29.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_28: "Minimize the admission of containers with the NET_RAW capability"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-27.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_22: "Use read-only filesystem for containers where possible"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-21.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_20: "Containers should not run with allowPrivilegeEscalation"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-19.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_40: "Containers should run as a high UID to avoid host conflict"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-37.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_21: "The default namespace should not be used"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_29: "Apply security context to your pods and containers"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/ensure-securitycontext-is-applied-to-pods-and-containers.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_15: "Image Pull Policy should be Always"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-14.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_37: "Minimize the admission of containers with capabilities assigned"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-34.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_8: "Liveness Probe Should be Configured"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-7.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_9: "Readiness Probe Should be Configured"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-8.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_38: "Ensure that Service Account Tokens are only mounted where necessary"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-35.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_43: "Image should use digest"
	FAILED for resource: Deployment.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-39.html

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV_K8S_21: "The default namespace should not be used"
	FAILED for resource: Service.default.azure-vote-back
	File: /terraform/agic/deployment.yaml:34-43
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20.html

		34 | apiVersion: v1
		35 | kind: Service
		36 | metadata:
		37 |   name: azure-vote-back
		38 | spec:
		39 |   ports:
		40 |   - port: 6379
		41 |   selector:
		42 |     app: azure-vote-back
		43 | ---

Check: CKV_K8S_23: "Minimize the admission of root containers"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-22.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_30: "Apply security context to your containers"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-28.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_31: "Ensure that the seccomp profile is set to docker/default or runtime/default"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-29.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_28: "Minimize the admission of containers with the NET_RAW capability"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-27.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_22: "Use read-only filesystem for containers where possible"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-21.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_20: "Containers should not run with allowPrivilegeEscalation"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-19.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_40: "Containers should run as a high UID to avoid host conflict"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-37.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_21: "The default namespace should not be used"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_29: "Apply security context to your pods and containers"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/ensure-securitycontext-is-applied-to-pods-and-containers.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_15: "Image Pull Policy should be Always"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-14.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_37: "Minimize the admission of containers with capabilities assigned"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-34.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_8: "Liveness Probe Should be Configured"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-7.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_9: "Readiness Probe Should be Configured"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-8.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_38: "Ensure that Service Account Tokens are only mounted where necessary"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-35.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_43: "Image should use digest"
	FAILED for resource: Deployment.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-39.html

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

Check: CKV_K8S_21: "The default namespace should not be used"
	FAILED for resource: Service.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:76-86
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20.html

		76 | apiVersion: v1
		77 | kind: Service
		78 | metadata:
		79 |   name: azure-vote-front
		80 | spec:
		81 |   type: LoadBalancer
		82 |   ports:
		83 |   - port: 80
		84 |   selector:
		85 |     app: azure-vote-front
		86 | ---

Check: CKV_K8S_21: "The default namespace should not be used"
	FAILED for resource: Ingress.default.azure-vote-front
	File: /terraform/agic/deployment.yaml:87-103
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20.html

		87  | apiVersion: networking.k8s.io/v1
		88  | kind: Ingress
		89  | metadata:
		90  |   name: azure-vote-front
		91  |   annotations:
		92  |     kubernetes.io/ingress.class: azure/application-gateway
		93  | spec:
		94  |   rules:
		95  |     - http:
		96  |         paths:
		97  |           - path: /
		98  |             pathType: Prefix
		99  |             backend:
		100 |               service:
		101 |                 name: azure-vote-front
		102 |                 port: 
		103 |                   number: 80

Check: CKV2_K8S_6: "Minimize the admission of pods which lack an associated NetworkPolicy"
	FAILED for resource: Pod.default.azure-vote-back.app-azure-vote-back
	File: /terraform/agic/deployment.yaml:1-33

		1  | apiVersion: apps/v1
		2  | kind: Deployment
		3  | metadata:
		4  |   name: azure-vote-back
		5  | spec:
		6  |   replicas: 1
		7  |   selector:
		8  |     matchLabels:
		9  |       app: azure-vote-back
		10 |   template:
		11 |     metadata:
		12 |       labels:
		13 |         app: azure-vote-back
		14 |     spec:
		15 |       nodeSelector:
		16 |         "kubernetes.io/os": linux
		17 |       containers:
		18 |       - name: azure-vote-back
		19 |         image: mcr.microsoft.com/oss/bitnami/redis:6.0.8
		20 |         env:
		21 |         - name: ALLOW_EMPTY_PASSWORD
		22 |           value: "yes"
		23 |         resources:
		24 |           requests:
		25 |             cpu: 100m
		26 |             memory: 128Mi
		27 |           limits:
		28 |             cpu: 250m
		29 |             memory: 256Mi
		30 |         ports:
		31 |         - containerPort: 6379
		32 |           name: redis
		33 | ---

Check: CKV2_K8S_6: "Minimize the admission of pods which lack an associated NetworkPolicy"
	FAILED for resource: Pod.default.azure-vote-front.app-azure-vote-front
	File: /terraform/agic/deployment.yaml:44-75

		44 | apiVersion: apps/v1
		45 | kind: Deployment
		46 | metadata:
		47 |   name: azure-vote-front
		48 | spec:
		49 |   replicas: 1
		50 |   selector:
		51 |     matchLabels:
		52 |       app: azure-vote-front
		53 |   template:
		54 |     metadata:
		55 |       labels:
		56 |         app: azure-vote-front
		57 |     spec:
		58 |       nodeSelector:
		59 |         "kubernetes.io/os": linux
		60 |       containers:
		61 |       - name: azure-vote-front
		62 |         image: mcr.microsoft.com/azuredocs/azure-vote-front:v1
		63 |         resources:
		64 |           requests:
		65 |             cpu: 100m
		66 |             memory: 128Mi
		67 |           limits:
		68 |             cpu: 250m
		69 |             memory: 256Mi
		70 |         ports:
		71 |         - containerPort: 80
		72 |         env:
		73 |         - name: REDIS
		74 |           value: "azure-vote-back"
		75 | ---

arm scan results:

Passed checks: 12, Failed checks: 8, Skipped checks: 0

Check: CKV_AZURE_35: "Ensure default network access rule for Storage Accounts is set to deny"
	FAILED for resource: Microsoft.Storage/storageAccounts.[concat('diag', uniquestring(resourceGroup().id))]
	File: /torivar.com/resources/vmtemplate/azuredeploy.json:152-162
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/set-default-network-access-rule-for-storage-accounts-to-deny.html

		152 |         {
		153 |             "type": "Microsoft.Storage/storageAccounts",
		154 |             "apiVersion": "2018-11-01",
		155 |             "name": "[variables('storageAccountName')]",
		156 |             "location": "[parameters('location')]",
		157 |             "sku": {
		158 |                 "name": "Standard_LRS"
		159 |             },
		160 |             "kind": "Storage",
		161 |             "properties": {}
		162 |         },

Check: CKV_AZURE_3: "Ensure that 'supportsHttpsTrafficOnly' is set to 'true'"
	FAILED for resource: Microsoft.Storage/storageAccounts.[concat('diag', uniquestring(resourceGroup().id))]
	File: /torivar.com/resources/vmtemplate/azuredeploy.json:152-162

		152 |         {
		153 |             "type": "Microsoft.Storage/storageAccounts",
		154 |             "apiVersion": "2018-11-01",
		155 |             "name": "[variables('storageAccountName')]",
		156 |             "location": "[parameters('location')]",
		157 |             "sku": {
		158 |                 "name": "Standard_LRS"
		159 |             },
		160 |             "kind": "Storage",
		161 |             "properties": {}
		162 |         },

Check: CKV_AZURE_36: "Ensure 'Trusted Microsoft Services' is enabled for Storage Account access"
	FAILED for resource: Microsoft.Storage/storageAccounts.[concat('diag', uniquestring(resourceGroup().id))]
	File: /torivar.com/resources/vmtemplate/azuredeploy.json:152-162
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/enable-trusted-microsoft-services-for-storage-account-access.html

		152 |         {
		153 |             "type": "Microsoft.Storage/storageAccounts",
		154 |             "apiVersion": "2018-11-01",
		155 |             "name": "[variables('storageAccountName')]",
		156 |             "location": "[parameters('location')]",
		157 |             "sku": {
		158 |                 "name": "Standard_LRS"
		159 |             },
		160 |             "kind": "Storage",
		161 |             "properties": {}
		162 |         },

Check: CKV_AZURE_1: "Ensure Azure Instance does not use basic authentication(Use SSH Key Instead)"
	FAILED for resource: Microsoft.Compute/virtualMachines.[concat(parameters('prefix'), '-', parameters('vmName'))]
	File: /torivar.com/resources/vmtemplate/azuredeploy.json:290-342
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-1.html

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_17: "Ensure the web app has 'Client Certificates (Incoming client certificates)' set"
	FAILED for resource: Microsoft.Web/sites.[concat(uniqueString(concat(resourceGroup().id, subscription().id)), '-example-app')]
	File: /template.json:105-142
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-7.html

		105 |         {
		106 |             "apiVersion": "2020-06-01",
		107 |             "name": "[variables('webAppName')]",
		108 |             "type": "Microsoft.Web/sites",
		109 |             "location": "[parameters('location')]",
		110 |             "identity": {
		111 |                 "type": "SystemAssigned"
		112 |             },
		113 |             "tags": {
		114 |                 "CostCenter": "[parameters('costCenterTagValue')]",
		115 |                 "Environment": "[parameters('environment')]",
		116 |                 "IaC": "[concat('IaC-Release-',parameters('release'))]"
		117 |             },
		118 |             "dependsOn": [
		119 |                 "[resourceId('microsoft.insights/components/', variables('appInsightsName'))]",
		120 |                 "[resourceId('Microsoft.Web/serverfarms', variables('hostingPlanName'))]"
		121 |             ],
		122 |             "properties": {
		123 |                 "name": "[variables('webAppName')]",
		124 |                 "siteConfig": {
		125 |                     "appSettings": "[union(parameters('customAppSettings'),createArray(json(concat('{\"name\": \"APPINSIGHTS_INSTRUMENTATIONKEY\", \"value\": \"',reference(resourceId('microsoft.insights/components/', variables('appInsightsName'))).InstrumentationKey,'\"}')),json(concat('{\"name\": \"APPLICATIONINSIGHTS_CONNECTION_STRING\", \"value\": \"',reference(resourceId('microsoft.insights/components/', variables('appInsightsName'))).ConnectionString,'\"}')),json(concat('{\"name\": \"ApplicationInsightsAgent_EXTENSION_VERSION\", \"value\": \"~2\"}')),json(concat('{\"name\": \"XDT_MicrosoftApplicationInsights_Mode\", \"value\": \"recommended\"}')),json(concat('{\"name\": \"InstrumentationEngine_EXTENSION_VERSION\", \"value\": \"~1\"}')),json(concat('{\"name\": \"XDT_MicrosoftApplicationInsights_BaseExtensions\", \"value\": \"~1\"}'))))]",
		126 |                     "metadata": [
		127 |                         {
		128 |                             "name": "CURRENT_STACK",
		129 |                             "value": "[parameters('currentStack')]"
		130 |                         }
		131 |                     ],
		132 |                     "netFrameworkVersion": "[parameters('netFrameworkVersion')]",
		133 |                     "phpVersion": "[parameters('phpVersion')]",
		134 |                     "alwaysOn": "[variables('alwaysOn')]",
		135 |                     "minTlsVersion": "1.2"
		136 |                 },
		137 |                 "serverFarmId": "[resourceId('Microsoft.Web/serverfarms', variables('hostingPlanName'))]",
		138 |                 "hostingEnvironment": "[parameters('hostingEnvironment')]",
		139 |                 "clientAffinityEnabled": true,
		140 |                 "httpsOnly": true
		141 |             }
		142 |         },

Check: CKV_AZURE_18: "Ensure that 'HTTP Version' is the latest if used to run the web app"
	FAILED for resource: Microsoft.Web/sites.[concat(uniqueString(concat(resourceGroup().id, subscription().id)), '-example-app')]
	File: /template.json:105-142
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-8.html

		105 |         {
		106 |             "apiVersion": "2020-06-01",
		107 |             "name": "[variables('webAppName')]",
		108 |             "type": "Microsoft.Web/sites",
		109 |             "location": "[parameters('location')]",
		110 |             "identity": {
		111 |                 "type": "SystemAssigned"
		112 |             },
		113 |             "tags": {
		114 |                 "CostCenter": "[parameters('costCenterTagValue')]",
		115 |                 "Environment": "[parameters('environment')]",
		116 |                 "IaC": "[concat('IaC-Release-',parameters('release'))]"
		117 |             },
		118 |             "dependsOn": [
		119 |                 "[resourceId('microsoft.insights/components/', variables('appInsightsName'))]",
		120 |                 "[resourceId('Microsoft.Web/serverfarms', variables('hostingPlanName'))]"
		121 |             ],
		122 |             "properties": {
		123 |                 "name": "[variables('webAppName')]",
		124 |                 "siteConfig": {
		125 |                     "appSettings": "[union(parameters('customAppSettings'),createArray(json(concat('{\"name\": \"APPINSIGHTS_INSTRUMENTATIONKEY\", \"value\": \"',reference(resourceId('microsoft.insights/components/', variables('appInsightsName'))).InstrumentationKey,'\"}')),json(concat('{\"name\": \"APPLICATIONINSIGHTS_CONNECTION_STRING\", \"value\": \"',reference(resourceId('microsoft.insights/components/', variables('appInsightsName'))).ConnectionString,'\"}')),json(concat('{\"name\": \"ApplicationInsightsAgent_EXTENSION_VERSION\", \"value\": \"~2\"}')),json(concat('{\"name\": \"XDT_MicrosoftApplicationInsights_Mode\", \"value\": \"recommended\"}')),json(concat('{\"name\": \"InstrumentationEngine_EXTENSION_VERSION\", \"value\": \"~1\"}')),json(concat('{\"name\": \"XDT_MicrosoftApplicationInsights_BaseExtensions\", \"value\": \"~1\"}'))))]",
		126 |                     "metadata": [
		127 |                         {
		128 |                             "name": "CURRENT_STACK",
		129 |                             "value": "[parameters('currentStack')]"
		130 |                         }
		131 |                     ],
		132 |                     "netFrameworkVersion": "[parameters('netFrameworkVersion')]",
		133 |                     "phpVersion": "[parameters('phpVersion')]",
		134 |                     "alwaysOn": "[variables('alwaysOn')]",
		135 |                     "minTlsVersion": "1.2"
		136 |                 },
		137 |                 "serverFarmId": "[resourceId('Microsoft.Web/serverfarms', variables('hostingPlanName'))]",
		138 |                 "hostingEnvironment": "[parameters('hostingEnvironment')]",
		139 |                 "clientAffinityEnabled": true,
		140 |                 "httpsOnly": true
		141 |             }
		142 |         },

Check: CKV_AZURE_35: "Ensure default network access rule for Storage Accounts is set to deny"
	FAILED for resource: Microsoft.Storage/storageAccounts.[concat(parameters('storagePrefix'), uniqueString(subscription().id, parameters('rgName')))]
	File: /deploy.json:46-55
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/set-default-network-access-rule-for-storage-accounts-to-deny.html

		46 |             {
		47 |               "type": "Microsoft.Storage/storageAccounts",
		48 |               "apiVersion": "2021-04-01",
		49 |               "name": "[variables('storageName')]",
		50 |               "location": "[parameters('rgLocation')]",
		51 |               "sku": {
		52 |                 "name": "Standard_LRS"
		53 |               },
		54 |               "kind": "StorageV2"
		55 |             }

Check: CKV_AZURE_36: "Ensure 'Trusted Microsoft Services' is enabled for Storage Account access"
	FAILED for resource: Microsoft.Storage/storageAccounts.[concat(parameters('storagePrefix'), uniqueString(subscription().id, parameters('rgName')))]
	File: /deploy.json:46-55
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/enable-trusted-microsoft-services-for-storage-account-access.html

		46 |             {
		47 |               "type": "Microsoft.Storage/storageAccounts",
		48 |               "apiVersion": "2021-04-01",
		49 |               "name": "[variables('storageName')]",
		50 |               "location": "[parameters('rgLocation')]",
		51 |               "sku": {
		52 |                 "name": "Standard_LRS"
		53 |               },
		54 |               "kind": "StorageV2"
		55 |             }

secrets scan results:

Passed checks: 0, Failed checks: 1, Skipped checks: 0

Check: CKV_SECRET_6: "Base64 High Entropy String"
	FAILED for resource: 18882f2ed5b844431259bb5cd75cea88b80365e2
	File: /terraform/insecure/keyvault/main.tf:6-7
	Guide: https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/secrets-policies/secrets-policy-index/git-secrets-6.html

		6 |   client_secret   = "insecu*********************"

github_actions scan results:

Passed checks: 181, Failed checks: 7, Skipped checks: 0

Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Run Megalinter on Terraform)
	File: /.github/workflows/megalinter-terraform.yml:21-22
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Terraform plan and apply)
	File: /.github/workflows/caller.yml:0-1
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Run KICS Terraform scan)
	File: /.github/workflows/kics.yaml:0-1
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(MSDO windows-latest)
	File: /.github/workflows/msdevopssec.yml:0-1
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on((Prod) TF Apply)
	File: /.github/workflows/calling.yml:35-36
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Run checkov Terraform scan)
	File: /.github/workflows/checkov.yaml:0-1
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(MegaLinter)
	File: /.github/workflows/mega-linter.yml:26-27


